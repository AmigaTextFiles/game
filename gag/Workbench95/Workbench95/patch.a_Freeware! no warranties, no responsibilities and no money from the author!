*
*
*	don't take this source to serious - it's only a hack!
*
*

	OPT !
	
******************************************************

	MACHINE 68000

******************************************************

	INCDIR	INCLUDE:
	INCLUDE	exec/funcdef.i
	INCLUDE	exec/exec_lib.i
	INCLUDE	exec/tasks.i
	INCLUDE	exec/macros.i
	INCLUDE	exec/execbase.i
	INCLUDE	intuition/intuition.i

******************************************************

	SECTION TEXT,CODE

******************************************************

	XDEF	_NewVector1
	XDEF _OldVector1
	XDEF	_NewVector2
	XDEF _OldVector2

******************************************************

	XREF	_Before_OpenWindow
	XREF	_After_OpenWindow
	XREF	_Before_CloseWindow
	XREF	_After_CloseWindow

******************************************************

_NewVector1:

	movem.l	d1-d7/a0-a6,-(SP)
	moveq	#0,d7
	move.l	a0,-(SP)
	jsr		_Before_OpenWindow
	move.l	(SP)+,a0
	btst.l	#0,d0
	beq.b	yes
	move.l	d0,d7
;	and.l	#-2,d7
	bclr.l	#0,d7
yes
	and.l	#-2,d0
nope	move.l	d0,a1

	move.l	d7,-(SP)
	dc.w 	$4EB9
_OldVector1:			; JSR $00000000.l
	dc.l 	0
	move.l	(SP)+,d7

	tst.l	d7
	beq.b	nope2
	move.l	d0,-(SP)
	move.l	d0,a0
	move.l	d7,a1
	jsr		_After_OpenWindow
	move.l	(SP)+,d0
nope2
	movem.l	(SP)+,d1-d7/a0-a6
	rts

******************************************************

_NewVector2:

	movem.l	d0-d7/a0-a6,-(SP)
	move.l	a0,-(SP)
	jsr		_Before_CloseWindow
	move.l	(SP)+,a0
	move.l	d0,-(SP)
	dc.w 	$4EB9
_OldVector2:
	dc.l 	0
	move.l	(SP)+,a0
	jsr		_After_CloseWindow
	movem.l	(SP)+,d0-d7/a0-a6
	rts

******************************************************

	END

******************************************************
