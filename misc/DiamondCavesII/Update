; $VER DC2-Update 1.4 (26.12.97)

(if (> (exists ("env:Language")) 0) (set lanfound (getenv "Language")) )
(set lan 0)
(set #lanQuestion "Please select language:")
(set #nohelp "Sorry, no help-text.")
(if (= "deutsch" lanfound)
    (
        (set lan 1)
        (set #lanQuestion "Bitte Sprache auswählen:")
        (set #nohelp "Sorry, kein help-text.")
    )
)

(set DrawerNameParent @default-dest)
(set version 0)

(complete 0)

(set lan  (askchoice (choices "English" "Deutsch"
                         (prompt #lanQuestion)
                         (help #nohelp)
                         (default lan)
                     )
          )
)

(if (= lan 0)
    (
        (set #notinstalled "Program 'DiamondCavesII' not found in the specified drawer. Process aborted.")
        (set #alreadyinstalled "You have already installed a version greater or equal 1.4!")
        (set #copy "Copying...")
        (set #whichdrawer "Where is your current version of Diamond Caves II installed?")
        (set #end "\nDiamond Caves II update complete.\n\nHave fun!")
    )
    (
        (set #notinstalled "Programm 'DiamondCavesII' im angegebenen Ordner nicht gefunden. Update abgebrochen.")
        (set #alreadyinstalled "Es ist schon eine Version größer oder gleich V1.4 installiert!")
        (set #copy "Kopiere...")
        (set #whichdrawer "Wo haben Sie Ihre jetzige Version von Diamond Caves II installiert?")
        (set #end "\nDas Diamond Caves II update ist fertig.\n\nViel Spaß!")
    )
)

(complete 0)
(set DrawerNameParent
     (askdir
         (prompt #whichdrawer)
         (help #nohelp)
         (default DrawerNameParent)
     )
)

(set ProgName (tackon DrawerNameParent "DiamondCavesII"))
(set DataDrawer (tackon DrawerNameParent "data"))

(if (exists ProgName (NOREQ))
    (

        (set vernum (getversion ProgName))

        (set ver (/ vernum 65536))
        (set rev (- vernum (* ver 65536)))

        (set version (+ (* 100 ver) rev))

        (if (> version 103)
            (
                (message #alreadyinstalled)
                (exit (quiet))
            )
        )

        (complete 20)
        (copyfiles
            (prompt #copy)
            (help #nohelp)
            (source "DiamondCaves2/DiamondCavesII")
            (dest DrawerNameParent)
        )

        (complete 40)
        (copyfiles
            (prompt #copy)
            (help #nohelp)
            (source "DiamondCaves2/DiamondEditII")
            (dest DrawerNameParent)
        )

        (complete 50)
        (copyfiles
            (prompt #copy)
            (help #nohelp)
            (source "DiamondCaves2/data/2")
            (dest DataDrawer)
        )

        (complete 60)
        (copyfiles
            (prompt #copy)
            (help #nohelp)
            (source "DiamondCaves2/DiamondCavesII.guide")
            (dest DrawerNameParent)
        )

        (complete 70)
        (copyfiles
            (prompt #copy)
            (help #nohelp)
            (source "DiamondCaves2/data/5")
            (dest DataDrawer)
        )

        (complete 80)
        (copyfiles
            (prompt #copy)
            (help #nohelp)
            (source "DiamondCaves2/DiamondCavesIID.guide")
            (dest DrawerNameParent)
        )
    )
    (
        (message #notinstalled)
        (exit (quiet))
    )
)

(complete 100)
(message #end)

(exit (quiet))
