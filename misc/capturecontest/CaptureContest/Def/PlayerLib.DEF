
(*###########################*)
 DEFINITION MODULE PlayerLib;        (* $VER: PlayerLib.def 0.0 (29.1.2011) *)
(*###########################*)

(*
Copyright (C) 2010 Thomas Breeden, All Rights Reserved.
                   Aglet Software
                   PO Box 99
                   Free Union, VA 22940

Permission to use, copy, modify and distribute this software and its
documentation for any purpose and without fee is hereby granted, provided that
the above copyright notice appear in all copies and that both the copyright
notice and this permission notice appear in supporting documentation.
Thomas Breeden makes no representations about the suitability of this software
for any purpose. It is provided "as is" without express or implied warranty.
*)

FROM CaptureSpecs IMPORT NumBumpers, NumPucks, NumSleds,
                         TrailMaxPoints;

FROM DynStr0 IMPORT DynStr;
FROM PipeIO  IMPORT PipeFile;
IMPORT Str0;

CONST LF        = 12C;
      CR        = 15C;

TYPE XY        = (X, Y);
     Point     = ARRAY XY OF REAL;

     LineSeg   = RECORD
                   p1,
                   p2     :Point;
                  END;

     GameColors = (MyColor, HisColor, GreyColor);

TYPE PipeInfo   = RECORD
                    pipeName :Str0.String32;
                    pipeF    :PipeFile;
                  END;

     PuckInfo   = RECORD
                     num     :INTEGER;
                     pos,
                     speed   :Point;
                     color   :GameColors;
                  END;

     BumperInfo   = RECORD
                       pos,
                       speed      :Point;
                       veloc      :REAL;
                    END;

     SledInfo   = RECORD
                     pos            :Point;
                     direct         :REAL;    (* radians *)
                     TrailNumPoints :INTEGER;
                     Trail          :ARRAY [0..TrailMaxPoints-1] OF Point;
                  END;

     PucksArray   = ARRAY[0..NumPucks-1] OF PuckInfo;
     BumpersArray = ARRAY[0..NumBumpers-1] OF BumperInfo;
     SledsArray   = ARRAY[0..NumSleds-1] OF SledInfo;

 PROCEDURE DebugReal(msg:ARRAY OF CHAR; i:INTEGER; r:REAL);
 PROCEDURE DebugReal2(msg:ARRAY OF CHAR; i:INTEGER; r1, r2:REAL);

 PROCEDURE WriteLn(f:PipeFile);
 PROCEDURE WriteString(f:PipeFile; s:ARRAY OF CHAR);
 PROCEDURE WriteInt(f:PipeFile; i:INTEGER);
 PROCEDURE WriteReal(f:PipeFile; r:REAL);
 PROCEDURE WritePoint(f:PipeFile; p:Point);

 PROCEDURE OutGameMove(f:PipeFile; Bump1Accel, Bump2Accel:Point; SledTurn:REAL);

 PROCEDURE ReadPuck(VAR Puck:PuckInfo);
 PROCEDURE ReadBumper(VAR Bumper:BumperInfo);
 PROCEDURE ReadSled(VAR Sled:SledInfo);

 PROCEDURE InGameState(f:PipeFile; VAR TurnNum:INTEGER; VAR Pucks:PucksArray; VAR Bumpers:BumpersArray; VAR Sleds:SledsArray);

END PlayerLib.

