
(*##############################*)
 DEFINITION MODULE CaptureSpecs;        (* $VER: CaptureSpecs.DEF 0.0 (24.1.2011) *)
(*##############################*)

(*
Copyright (C) 2010 Thomas Breeden, All Rights Reserved.
                   Aglet Software
                   PO Box 99
                   Free Union, VA 22940

Permission to use, copy, modify and distribute this software and its
documentation for any purpose and without fee is hereby granted, provided that
the above copyright notice appear in all copies and that both the copyright
notice and this permission notice appear in supporting documentation.
Thomas Breeden makes no representations about the suitability of this software
for any purpose. It is provided "as is" without express or implied warranty.
*)

FROM SimpleGraphics  IMPORT XY;

CONST ScreenSize           = 800.0;
      MaxBumperVelocity    =  24.0;
      MaxBumperVelocDelta  =   8.0;
      SledVelocity         =  15.0;
      MaxSledTurn          =   0.5;  (* ABS(radians) ~28° *)
      MaxSledTrailLen      = 600.0;
      BumperRadius         =   8.0;
      BumperMass           =   8.0;
      PuckRadius           =   5.0;
      PuckMass             =   3.0;
      PuckFriction         =   1.0;

CONST NumBumpers           =   4;
      NumPucks             = 112;
      NumSleds             =   2;
      NumWalls             =   4;

      RedSledIndex         = 0;
      BlueSledIndex        = 1;

TYPE  Point     = ARRAY XY OF REAL;
      LineSeg   = RECORD
                    p1,
                    p2     :Point;
                    (*hidden :BOOLEAN;*)
                   END;

TYPE  BumperIndices   =  [0..NumBumpers-1];
      MyBumperIndices =  [0..1];
      HisBumperIndices = [2..3];

CONST MilliSecsPerTurn     = 100;
      TurnsPerGame         = 900;
      MaxStepsPerTurn      = 4;           (* 100 msec turns, granularity of the movement simulation no better than 25 msec *)
      TrailMaxPoints       = MaxStepsPerTurn*40+15;  (* 40 steps at the sled speed = MaxSledTrailLen *)
                                                     (* plus some extra for wrap around cases *)

TYPE  GameColors  = (RedPlayer, BluePlayer, NoPlayer);
      GamePlayers = GameColors[RedPlayer..BluePlayer];

      ObjSpecs    = RECORD
                      pos     :Point;
                      color   :GameColors;
                      moved,
                      marked  :BOOLEAN;
                    END;
      ObjSpecsPtr = POINTER TO ObjSpecs;

      SledSpecs   = RECORD
                      pos            :Point;
                      color          :GameColors;
                      direct         :REAL;                            (* radians *)
                      TrailHeadPos   :CARDINAL;
                      Trail          :ARRAY [0..TrailMaxPoints-1] OF Point(*LineSeg*);
                      TrailNumPoints :CARDINAL;
                    END;

      PuckObjsDesc   = ARRAY [0..NumPucks-1] OF ObjSpecs;     PuckObjsDescPtr = POINTER TO PuckObjsDesc;
      BumperObjsDesc = ARRAY [0..NumBumpers-1] OF ObjSpecs;   BumperObjsDescPtr = POINTER TO BumperObjsDesc;
      WallObjsDesc   = ARRAY [0..NumWalls-1] OF ObjSpecs;     WallObjsDescPtr = POINTER TO WallObjsDesc;
      SledObjsDesc   = ARRAY [0..NumSleds-1] OF SledSpecs;    SledObjsDescPtr = POINTER TO SledObjsDesc;


 PROCEDURE IsHidden(lin:LineSeg):BOOLEAN;

END CaptureSpecs.
