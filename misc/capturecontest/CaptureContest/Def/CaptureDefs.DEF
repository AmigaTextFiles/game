
(*############################*)
 DEFINITION MODULE CaptureDefs;        (* $VER: CaptureDefs.DEF 0.0 (24.1.2011) *)
(*############################*)

FROM DynStr0         IMPORT DynStr;
FROM CaptureSpecs    IMPORT BumperObjsDescPtr, GameColors,
                            NumBumpers, NumPucks, NumSleds, NumWalls,
                            ObjSpecs, Point, PuckObjsDescPtr,
                            SledObjsDesc, WallObjsDescPtr;

CONST TurnsPerGame         = 900;

      MaxSimulCollides     = 10;

TYPE  CollideObj    = (BumperObj, PuckObj, WallObj);
      CollideInfo   = RECORD
                        colltime :REAL;
                        inx1,
                        inx2     :INTEGER;
                        obj1,
                        obj2     :CollideObj;
                      END;

      ObjectInfo = RECORD
                     speed        :Point;
                     veloc        :REAL;
                     prevpos      :Point;
                     prevveloc    :REAL;
                   END;
      ObjInfoPtr = POINTER TO ObjectInfo;

      SledInfo   = RECORD
                     speed          :Point;
                     veloc          :REAL;
                     TrailTailPos   :CARDINAL;
                     TrailNumHidden :CARDINAL;
                     loopP          :Point;         (* ie, crossing point, (-1.0,-1.0) means no loop *)
                     loopSeg        :CARDINAL;
                   END;

      PucksInfoDesc    = ARRAY [0..NumPucks-1] OF ObjectInfo;     PucksInfoDescPtr = POINTER TO PucksInfoDesc;
      BumpersInfoDesc  = ARRAY [0..NumBumpers-1] OF ObjectInfo;   BumpersInfoDescPtr = POINTER TO BumpersInfoDesc;
      SledsInfoDesc    = ARRAY [0..NumSleds-1] OF SledInfo;       SledsInfoDescPtr = POINTER TO SledsInfoDesc;

      MovingObjectInfo  = RECORD CASE otyp:CollideObj OF
                                   BumperObj: specsB  :BumperObjsDescPtr;
                                              infoB   :BumpersInfoDescPtr; |
                                   PuckObj:   specsP  :PuckObjsDescPtr;
                                              infoP   :PucksInfoDescPtr;   |
                                   WallObj:   specsW  :WallObjsDescPtr;
                                 END END;

VAR   MovingObjects     :ARRAY CollideObj OF MovingObjectInfo;

      Sleds             :RECORD
                           specsS: SledObjsDesc;
                           infoS:  SledsInfoDesc;
                         END;

      TurnNum           :INTEGER;
      StepsPerTurn,
      StepsPerDisplay,
      StepNum,
      DisplayNum        :CARDINAL;
      TurnMillis,
      StepMillis,
      DisplayMillis     :REAL;

      RedPlayerExe,
      BluePlayerExe     :DynStr;

      TraceFileName     :DynStr;

      QuietMode,
      InteractiveMode,
      PauseMode         :BOOLEAN;

END CaptureDefs.

