; $VER InstallEditor 1.1 (04.06.95)

(set Update 0)
(set version 0)
(set DrawerName "DC:")

(complete 0)
(if (exists "DC:" (NOREQ))
    (

        (if (exists "DC:DiamondEditor" (NOREQ))
            (
                (set vernum (getversion "DC:DiamondEditor"))

                (set ver (/ vernum 65536))
                (set rev (- vernum (* ver 65536)))

                (set version (+ (* 100 ver) rev))

                (if (> version 100)
                    (
                        (message "You have already installed a version greater or equal 1.1!\n")
                        (exit (quiet))
                    )
                )

                (set Update
                    (askchoice
                        (prompt "Diamond Caves Editor V" ver "." rev " already installed.\nDo you want to update or install completely new?")
                        (choices "Install new" "Update")
                        (help "Soory, no help-file.")
                        (default 1)
                    )
                )
            )
        )
    )
    (
        (message "Directory "DC:" not found!\nYou need an installed Version of Diamond Caves to run the Diamond Caves Editor.")
        (exit (quiet))
    )
)

(if (= Update 1)                  ; only Update according to present Version
    (
        (complete 30)
        (if (< version 100)         ; this is only for versions <1.0 (gfx-data)
            (copyfiles
                (prompt "Copying necessary files to \"" DrawerName "\".")
                (help @copyfiles-help)
                (source "new")
                (dest DrawerName)
                (all)
                (infos)
            )
        )

        (complete 60)
        (if (< version 101)         ; update from V1.0 (main-prg, guide)
            (copyfiles
                (prompt "Copying necessary files to \"" DrawerName "\".")
                (help @copyfiles-help)
                (source "UpdateFromV1.0")
                (dest DrawerName)
                (all)
                (infos)
            )
        )

    )

    (                             ; new install: copy everything to "DrawerName" (should be "DC:" !)
        (complete 10)
        (set icons
            (askchoice
                (prompt "What kind of Icons do you want?\n")
                (choices "normal" "MagicWB" "none")
                (help "Soory, no help-file.")
                (default 0)
            )
        )

        (if (= icons 0)
            (
                (copyfiles
                    (prompt "Copying necessary Icons to \"" DrawerName "\".")
                    (help @copyfiles-help)
                    (source "Icons/normal")
                    (dest DrawerName)
                    (all)
                    (infos)
                )
            )
        )
        (if (= icons 1)
            (
                (copyfiles
                    (prompt "Copying necessary Icons to \"" DrawerName "\".")
                    (help @copyfiles-help)
                    (source "Icons/MagicWB")
                    (dest DrawerName)
                    (all)
                    (infos)
                )
            )
        )

        (complete 30)
        (copyfiles
            (prompt "Copying necessary files to \"" DrawerName "\".")
            (help @copyfiles-help)
            (source "new")
            (dest DrawerName)
            (all)
            (infos)
        )

        (complete 60)
        (copyfiles
            (prompt "Copying necessary files to \"" DrawerName "\".")
            (help @copyfiles-help)
            (source "UpdateFromV1.0")
            (dest DrawerName)
            (all)
            (infos)
        )

    )
)

(complete 100)
(message "\nDiamond Caves Editor V1.1 installation/update complete.\n\nHave fun!")

(exit (quiet))
