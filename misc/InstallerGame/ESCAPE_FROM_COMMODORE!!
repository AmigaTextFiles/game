; "Escape from Commodore!"
;  Version 1.0
;
; Advtenture game written for Commodore's installer utilitiy.
; Concept and programming by Greg Simon (5/6/93)
; This code is freely distrubutable, as long as you keep my name on 
; it, and don't modify it.
;
; It may serve useful to use as an example for writing Installer 
; scripts for actually INSTALLING something...not playing games.
;
; Installer is really a great utility, and let me take this moment
; to complement C= and all the work that went into making it--
; especially it's entry into the public--so that users (other
; than developers only) can use it!  Way to go C=!
;
;********************************************************************
;  HEY!  WIN THE GAME FIRST, THEN READ THE SOURCE...OTHER WISE YOU
;  MIGHT CHEAT..IT'S -VERY- TEMPTING, I KNOW...
;********************************************************************
;
; Write to the author (me) Greg Simon (flames, suggestions, comments)
;
; gs@teetot.acusd.edu
;
; Greg Simon
; 2 KingsWoods Drive.
; New Hope, PA 18938
;
;
;********************************************************************

(set hasdos4 0)
(set hasblaze 0)
(complete 0 )



(procedure HALLWAY

   (message "\n\nHALLWAY\n\nYou are in the main hallway of Commodore Business Machines.  There are many doors to enter here.  Employees shuffle by murmering things about Marketing...\n\nThere are numerous doors here; leading to the many facets of the CBM building.  Down the hall you see the Graphics Dept, and the OS Dept.")
   (set answer
      (askchoice
         (prompt "What door do you want to enter?")
         (choices "Commodore-Cafe(tm)" "Networking Dept." "Graphics Dept."
                  "OS Dept."           "Software Vault"   "R&D lab"
                  "Lobby")      
         (help helpstring)
      )
   )
   (if (= answer 0) (CAFE))
   (if (= answer 1) (NETWORKING))
   (if (= answer 2) (GFX))
   (if (= answer 3) (OS))
   (if (= answer 4) (VAULT))
   (if (= answer 5) (RDLAB))
   (if (= answer 6) (LOBBY))

)

(procedure OS
   (message "\n\nOS Design LAB\n\nYou enter the OS design lab, and see Mike Sinz working on some assembly code.  He motions to you to come over.")
   (message "He says, \"You think we should release resource tracking in 4.0?  or maybe wait until version 5?\"")
   (set answer
      (askchoice
         (prompt "Say someting:")
         (choices "\"Let's release it in 4.0.\"" "\"Nahhh, we don't need resource tracking.\"")
         (help helpstring)
      )
   )
   (message "\n\nMike says, \"thanks for your opinion, but I was just kidding..\" (laughs)")
   (HALLWAY)
)

(procedure RDLAB
   (message "\n\n\nYou enter the \"way-cool high end Amigas\" lab.  Dave Haynie and George Robbins are here working on the AAA chipset!")
   (message ("\n\n\nDave says, \"Uhhhh, hi %s; and what are you doing here...this is a restricted area!\""name))
   (message "\n\n\n\nYou wave goodbye (Dave and George wave back) and leave the LAB.   As you leave though, you *swear* you saw a box on the bench with an "Amiga 5000" label on it, nah...")
   (HALLWAY)
)

(procedure CAFE
   (message "\n\nCommodoreCafe(tm)\n\nYou stride into the Commodore-Cafe(tm).  There are numerous employees here stuffing their faces, and murmering about marketing.\n\nOne guy in the corner motions over to you.")
   (set answer
      (askchoice
         (prompt "What do you want to do?")
         (choices "Buy a cookie shaped like the Amiga Logo." "Go talk to the guy waving at you" "Leave the Cafe")
         (help helpstring)
      )
   )
   (if (= answer 0) 
      (
         (message "\n\n\nYou purchase an Amiga Cookie from the counter, and devour it.  hmmm...you wonder if A500's taste this way too...") 
         (HALLWAY) ))
   (if (= answer 1) (
      
      (message "\n\n\n\n\nHey! It's Harv Laser...famous Amiga personality.")
      (message ("\n\n\nHarv says- \"Hey there %s, haven't seen you on Portal(tm) or IRC lately...I can give you a hint to help you escape from Commodore though.\" " name ))
      (message "\n\n\n\n\nHarv takes a sip out of his Amiga Mug and says, \"blazemonger\" then vansishes ..:::poof")
      (complete 30 )
      (HALLWAY))
   )
   (if (= answer 2) (HALLWAY))

)

(procedure VAULT
   (if (= hasdos4 0)
      (
         (message "\n\nSoftware Vault\n\nYou are in the Commodore Software Vault.  On the shelf is the source code to AmigaDOS 1.0--3.0.\n\nMarc Barrett is chained up in the corner looking like he's allergic to the Kickstart source code.")
            (message "\n\n\n\nThere is a box labeled 'Kickstart 4.0a' sitting on the ground.")
         (set answer
            (askchoice
               (prompt "What do you want to do?")
               (choices "Leave the vault" "Take the 4.0 kickStart source")
               (help helpstring)
            )
         )
         (if (= answer 0) (HALLWAY))
         (if (= answer 1) ( (set hasdos4 1) (complete 40 ) (VAULT)   ))
      )
   )

   (if (= hasdos4 1)
   (
      (message "\n\nSoftware Vault\n\nYou are in the Commodore Software Vault.  On the shelf is the source code to AmigaDOS 1.0--3.0.  Marc Barrett is chained up in the corner looking like he's allergic to the Kickstart source code.")
      (HALLWAY)
   ))

)

(procedure NETWORKING
   (message "\n\nNetWorking\n\nYou enter the Commodore Networking Department.  Ken Dyke is there, with his terminal logged into IRC.  There seems to be a heated debate going on in IRC...better leave")
   (HALLWAY)
)

(procedure GFX
   (message "\n\nGraphics Department\n\nAs you push the door to graphics open, Chris Green comes up to you.")
   (message ("\n\n\nChris says, \"Hey %s, I was just about to call you, I need the 4.0 source code form the vault.\"" name))
   (set answer
      (askchoice
         (prompt "It's your move")
         (choices "Give him the source code" "Leave the room" )
         (help helpstring)
      )
   )
   (if (= answer 0)(
      (if (= hasdos4 0)
         (
            (message "\n\nYou dont have DOS 4...!  Chris gives you the dumb look that you obviously deserve, as you turn and leave the room.")
            (HALLWAY)
         )
      )
      (if (= hasdos4 1)
         (
            (message "\n\nYou hand the box of Kickstart 4.0 source to Chris.  He says 'thanks, ..oh!  Dan Barrett was here earlier, and dropped this off for you.\n\nHe hands you a box which says: 'FRAGILE, BLAZEMONGER inside.'  You leave the room.")
            (set hasblaze 1)
            (set hasdos4 0)
            (complete 70 )
            (HALLWAY)
         )
      )
   ))
   (if (= answer 1) ( (message "\n\nYou point to a corner of the room, everyone turns to look, and you run out of the room.") (HALLWAY)  ))
)

(procedure LOBBY
   (message "\n\nLOBBY\n\nYou enter the Commodore Lobby, where Fred Fish is passing out the latest disks.  He is also letting certain employees leave the Commodore Offices, for reasons you don't know.")
   (set answer
      (askchoice
         (prompt "What shall you so now?")
         (choices "Try to slip out the door" "Breakdance" "Give Fred something to submit to the Aquarium" )
         (help helpstring)
      )
   )
   (if (= answer 0)( 
      (message "\n\n\nYou try and sneak out the door, but Mr. Fish grabs you, and prevents you from leaving.  He says ''you oughta submit something to the library!''")
      (HALLWAY)
   ))
   (if (= answer 1) ( (message "\n\nYou begin to do the 'electric boogaloo' in the lobby.  Harv Laser comes out and starts clapping to the beat.  Everyone has stopped what they were doing, and are now watching you dance.  You feel good about yourself.") (HALLWAY)))
   (if (= answer 2) (
      (if (AND (= hasblaze 0) (= hasdos4 1))
         (
         (message "\n\nSurely you aren't thinking of submitting the source to kickstart...you pirate!")
         (HALLWAY)         
         )
      )
      (if (= hasblaze 1)
         (
         (message "\n\n\nIn one motion, you hand him the BLAZEMONGER box...\n\n'all right!' he proclaims. 'This will complete the collection!  Finally we have the mighty BLAZEMONGER!'")
         (WIN)
         )
      )
   ))
)

(procedure WIN
   (complete 100)
   (message "\n\n\nFred opens the door, and you walk out into sunny West Chester (yeah, right)")
   (message "\n\nCongratulations, you have completed the adventure.  Greg Simon (the author of the game) wishes to mention that all mention of real persons within this game were truely out of respect, and no one should feel instulted about being mentioned in this game.")
   (message "\nIf you have any flames, suggestions, ideas...write to me!  I'd love to hear from you!\n\ngs@teetot.acusd.edu\nGreg Simon\n2 Kingswoods Drive\nNew Hope PA 18938")
   (exit) 

)

(set name
   (askstring
      (prompt "\n\nPlease enter your name adventurer!")
      (help @askstring-help)
   )
)

(message ("\n\nWelcome to the worlds first Interactive game using Commodore's Installer Language!\n\n %s, you will be presented with choices to make, with the ultamite goal of finding a way OUT of the Commodore Business Machines Complex.\n\nGood Luck!" name ))
(set helpstring
   ("\n\nYou seriously don't want help.\n\nThis is a GAME, and it's not even that difficult...\n\noh well, keep on trying."))

(HALLWAY)

(abort
   "\n\n\nGiving up so soon?\n\nC'mon...it's not *THAT* difficult"
)