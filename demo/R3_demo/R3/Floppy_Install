; for those who like peeking at scripts before running them,
; this one should be quite safe.

; It can be aborted at any time, and always asks for confirmation.

echo "*NThis script installs the R3-Demo onto a floppy disk.*N"

echo "As a lot of small files need to be copied, I would NOT advise"
echo "running this script FROM floppy on a single-floppy-drive machine."
echo "One option would be to copy the R3 dir to RAM: before running."
echo ""
echo "If this script gets a weird error (and exits), try running from the CLI."
echo ""

failat 11
ask "Do you really want to install onto a floppy disk (y/n)?"
if warn
  echo ""
  ask "Do you have a blank formatted floppy available (y/n)?"
  if warn
    echo ""
    ask "OK.  Put it in DF0: and press return."
    echo ""
    install drive df0: check
    if not fail
      relabel df0: "R3_DEMO"
      if warn
        endcli
      endif
    else
      endcli
    endif
  else
    echo ""
    ask "Would you like me to format a disk for you (y/n)?"
    if warn
      echo ""
      sys:system/format drive df0: name "R3_DEMO"
      if warn
        endcli
      endif
    else
      echo "*NWell I need a disk.  Go buy one."
      endcli
    endif
  endif
  
  failat 10
  echo ""
  echo "Installing..."
  install drive DF0:
  if not warn
    makedir R3_DEMO:R3
    if not warn
      echo "*NCopying silly little files onto floppy...*N"
      makedir R3_DEMO:s
      copy Floppy_Install_junk/s/startup-sequence R3_DEMO:s
      copy all Floppy_Install_junk/#? R3_DEMO:
      if not warn
      copy libs:diskfont.librar? R3_DEMO:libs
      if not warn
      copy libs:mathtrans.librar? R3_DEMO:libs
      if not warn

        echo ""
        echo "Copying R3 directory..."
        echo ""
        copy /R3.info R3_DEMO:
        copy all Demo.levels/#? R3_DEMO:R3/Demo.levels
        if not warn
          copy all gfx/#? R3_DEMO:R3/gfx
          if not warn
            copy all snd/#? R3_DEMO:R3/snd
            if not warn
              copy all ships/#? R3_DEMO:R3/ships
              if not warn
                copy R#? R3_DEMO:R3
                echo ""
                echo "Copying stuff needed in KS1.3..."
                echo "(Files may not exist on KS2 and above - Don't worry about it.)"
                echo ""
                failat 21
                makedir R3_Demo:c
                copy c:CD R3_DEMO:c
                copy c:EndCli R3_DEMO:c
                copy c:Run R3_DEMO:c
                copy c:Failat R3_DEMO:c
                copy c:Assign R3_DEMO:c
                copy sys:system/FastMemFirst R3_DEMO:c
                echo ""
                echo "ALL DONE!  Have fun."
                endcli
              endif
            endif
          endif
        endif
        endif
        endif
      endif
    endif
  endif
  echo ""
  echo "Oh bugger.  Something went wrong."
else
  echo ""
  echo "Fine.  Go click on some other icons, then."
endif
