<HTML>
<HEAD>
<!-- This HTML file has been created by texi2html 1.51
     from ahidev.texinfo on 31 October 1997 -->

<TITLE>Ahi Developers's Guide - Declaring Sounds</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="ahidev_1.html">first</A>, <A HREF="ahidev_8.html">previous</A>, <A HREF="ahidev_10.html">next</A>, <A HREF="ahidev_21.html">last</A> section, <A HREF="ahidev_toc.html">table of contents</A>.
<P><HR><P>


<H2><A NAME="SEC18" HREF="ahidev_toc.html#TOC18">Declaring Sounds</A></H2>

<P>
<A NAME="IDX62"></A>
<A NAME="IDX63"></A>

</P>
<P>
<A NAME="IDX64"></A>
<A NAME="IDX65"></A>
<A NAME="IDX66"></A>
<A NAME="IDX67"></A>
<A NAME="IDX68"></A>
<A NAME="IDX69"></A>
<A NAME="IDX70"></A>

</P>
<P>
Before you can play a sample array, you must <CODE>AHI_LoadSound()</CODE> it.
Why?  Because if AHI knows what kind of sounds that will be played
later, tables and stuff can be set up in advance.  Some drivers may even
upload the samples to the sound cards local RAM and play all samples from
there, drastically reducing CPU and bus load.

</P>
<P>
You should <CODE>AHI_LoadSound()</CODE> the most important sounds first, since
the sound cards RAM may not be large enough to hold all your sounds.

</P>
<P>
<CODE>AHI_LoadSound()</CODE> also associates each sound or sample array with a
number, which is later used to refer to that particular sound.

</P>
<P>
 There are 2 types of sounds, namely <CODE>AHIST_SAMPLE</CODE> and
<CODE>AHIST_DYNAMICSAMPLE</CODE>.

</P>

<DL COMPACT>

<DT><CODE>AHIST_SAMPLE</CODE>
<DD>
<A NAME="IDX71"></A>
This is used for static samples.  Most sounds that will be played are of
this type.  Once the samples has been "loaded", you may not alter the
memory where the samples are located.  You may, however, read from it.

<DT><CODE>AHIST_DYNAMICSAMPLE</CODE>
<DD>
<A NAME="IDX72"></A>
If you wish to play samples that you calculate in realtime, or load in
portions from disk, you must use this type.  These samples will never be
uploaded to a sound cards local RAM, but always played from the normal
memory.  There is a catch, however.  Because of the fact that the sound is
mixed in chunks, you must have a certain number of samples in memory before
you start a sound of this type.  To calculate the size of the buffer (in
samples), use the following formula:


<PRE>
@math{size = samples * Fs / Fm}
</PRE>

where samples is the value returned from <CODE>AHI_GetAudioAttrsA()</CODE> when
called with the <CODE>AHIDB_MaxPlaySamples</CODE> tag, Fs is the highest
frequency the sound will be played at and Fm is the actual mixing frequency
(<CODE>AHI_ControlAudioA()/AHIC_MixFreq_Query</CODE>).

</DL>

<P>
The samples can be in one of four different formats, named <CODE>AHIST_M8S</CODE>,
<CODE>AHIST_S8S</CODE>, <CODE>AHIST_M16S</CODE>, and <CODE>AHIST_S16S</CODE>.

</P>
<DL COMPACT>

<DT><CODE>AHIST_M8S</CODE>
<DD>
<A NAME="IDX73"></A>
This is an 8 bit mono sound. Each sample frame is just one signed byte.

<DT><CODE>AHIST_S8S</CODE>
<DD>
<A NAME="IDX74"></A>
This is an 8 bit stereo sound. Each sample frame is one signed byte representing
the left channel, followed by another one for the right channel.

<DT><CODE>AHIST_M16S</CODE>
<DD>
<A NAME="IDX75"></A>
This is a 16 bit mono sound.  Each sample frame is just one signed 16 bit
word, in big endian/network order format (most significant byte first).

<DT><CODE>AHIST_S16S</CODE>
<DD>
<A NAME="IDX76"></A>
This is a 16 bit stereo sound.  Each sample frame is one signed 16 bit
word, in big endian/network order format (most significant byte first)
representing the left channel, followed by another one for the right
channel.

</DL>

<P>
<A NAME="IDX77"></A>

</P>
<P>
 If you know that you won't use a sound anymore, call
<CODE>AHI_UnloadSound()</CODE>.  <CODE>AHI_FreeAudio()</CODE> will also do that for you
for any sounds left when called.

</P>
<P>
 There is no need to place a sample array in <STRONG>Chip memory</STRONG>, but it
<STRONG>must not</STRONG> be swapped out!  Allocate your sample memory with the
<CODE>MEMF_PUBLIC</CODE> flag set.  If you wish to have your samples in virtual
memory, you have to write a double-buffer routine that copies a chunk of
memory to a <CODE>MEMF_PUBLIC</CODE> buffer.  The <STRONG>SoundFunc</STRONG> should signal a
task to do the transfer, since it may run in supervisor mode (see
<CODE>AHI_AllocAudioA()</CODE>).

</P>

<P><HR><P>
Go to the <A HREF="ahidev_1.html">first</A>, <A HREF="ahidev_8.html">previous</A>, <A HREF="ahidev_10.html">next</A>, <A HREF="ahidev_21.html">last</A> section, <A HREF="ahidev_toc.html">table of contents</A>.
</BODY>
</HTML>
