.\"Generated by db2man.xsl. Don't modify this, modify the source.
.de Sh \" Subsection
.br
.if t .Sp
.ne 5
.PP
\fB\\$1\fR
.PP
..
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Ip \" List item
.br
.ie \\n(.$>=3 .ne \\$3
.el .ne 3
.IP "\\$1" \\$2
..
.TH "CFED" 6 "November 22 2003" "" ""
.SH NAME
cfed \- a level compiler for Crimson Fields
.SH "SYNOPSIS"
.ad l
.hy 0
.HP 5
\fBcfed\fR \fImapsource\fR \-\-tiles\ \fItileset\fR \-\-units\ \fIunitset\fR
.ad
.hy
.ad l
.hy 0
.HP 5
\fBcfed\fR {\fB\-\-help\fR | \fB\-\-version\fR}
.ad
.hy

.SH "DESCRIPTION"

.PP
\fBcfed\fR is the Crimson Fields level compiler\&.

.PP
It creates a \fI*\&.lev\fR file out of a source file \fI*\&.src\fR\&. You can use any standard text editor to create the level source files (for the syntax of those files, see File Format below)\&. \fBcfed\fR reads the input file and creates the level file, which is named after the title given in the mission description, to the current directory\&. You can also have a look at the existing levels for more hints\&.

.SH "OPTIONS"

.TP
\fB\-\-help\fR
Print a usage message on standard output and exit\&.

.TP
\fB\-\-tiles\fR \fItileset\fR
Use the tile definitions from \fItileset\fR when compiling the map\&.

.TP
\fB\-\-units\fR \fIunitset\fR
Use the unit definitions from \fIunitset\fR when compiling the map\&.

.TP
\fB\-\-version\fR
Print version information on standard output and exit\&.

.SH "FILE FORMAT"

.PP
A level source file consists of sections\&. A section is started by the section name in square brackets, i\&.e\&. the line

.PP
[unit]

.PP
starts a unit section\&. Lines in a section are usually composed like this:

.PP
qualifier = value

.PP
The only exceptions to this are the map and messages sections\&. Lines starting with # are considered comments\&. The following sections exist:

.SS "mission"

.PP
This section defines some global mission parameters like map size or the graphics set to use\&. The mission section is mandatory and must appear before the map section in the file\&. Valid qualifiers are

.TP
title
mission title (maximum length 29 characters, mandatory)

.TP
mapwidth
[10\-200] (mandatory)

.TP
mapheight
[10\-200] (mandatory)

.TP
nextmap
index of a message containing the name of another map (without path and file ending)\&. After the current map has been completed, this new map will be loaded automatically\&. If this tag is omitted, the game will return to the main menu after the current map\&.

.TP
info
index of the information message that is to be shown when a player requests level information\&. This message can contain the level name, author, revision, etc\&.

.TP
password
A level may be protected by a password\&. This can be used in campaign games to play maps in a specific order\&. The password will not be checked if the map is loaded via the nextmap flag above\&. Level passwords must have exactly seven characters\&. All protected maps should tell the player about the access code in the level information message\&.

.TP
players
selects whether the map is intended for play against another human being (2) or against the computer (1)\&. This is for informational purposes only and defaults to 2\&.

.TP
tileset
tileset file to be used\&. A tileset contains the map graphics and terrain definitions\&. The filename must be given without the \fI\&.tiles\fR suffix\&. If omitted, the tile set defaults to 'default'\&.

.TP
unitset
unit set file to be used\&. A unit set contains the unit graphics and definitions\&. The filename must be given without the \fI\&.units\fR suffix\&. If omitted, the unit set defaults to 'default'\&.

.SS "map"

.PP
The map section defines the actual map layout\&. It is a rectangle of the size specified in the mission section, consisting of various symbols which describe a certain map tile type\&. The map section is mandatory and may not contain comments\&. The following symbols exist\&.

.TP
\&.
plains

.TP
*
forest

.TP
%
mountains

.TP
=
shallow water

.TP
~
water

.TP
\-
deep water

.TP
#
swamp

.TP
"
cliff

.TP
0
headquarters, neutral entrance, east

.TP
1
headquarters, yellow entrance, east

.TP
2
headquarters, blue entrance, east

.TP
3
depot, neutral entrance, north

.TP
4
depot, yellow entrance, north

.TP
5
depot, blue entrance, north

.TP
6
factory, neutral entrance, north

.TP
7
factory, yellow entrance, north

.TP
8
factory, blue entrance, north

.TP
9
factory, neutral entrance, east

.TP
J
factory, yellow entrance, east

.TP
L
factory, blue entrance, east

.TP
A
city, yellow

.TP
B
city, blue

.TP
C
city, neutral

.TP
D
headquarters, yellow entrance, west

.TP
E
headquarters, blue entrance, west

.TP
F
headquarters, neutral entrance, west

.TP
G
headquarters, yellow entrance, north

.TP
H
headquarters, blue entrance, north

.TP
I
headquarters, neutral entrance, north

.TP
>
headquarters, east

.TP
<
headquarters, west

.TP
^
headquarters, north

.TP
v
headquarters, south

.TP
\\
road, se\-nw

.TP
|
road, s\-n

.TP
/
road, sw\-ne

.TP
y
road, sw\-n\-ne

.TP
Y
road, se\-n\-nw

.TP
X
road, s\-se\-nw\-n

.TP
x
road, s\-sw\-n\-ne

.TP
o
road, sw\-nw\-ne\-se

.TP
k
road, sw\-s\-ne

.TP
K
road, s\-se\-nw

.TP
(
road, n\-se

.TP
)
road, n\-sw

.TP
]
road, nw\-s

.TP
[
road, ne\-s

.TP
n
road, sw\-se

.TP
u
road, nw\-ne

.TP
T
road, n\-s\-se

.TP
U
road, n\-s\-sw

.TP
V
road, n\-s\-ne

.TP
W
road, n\-s\-nw

.TP
!
bridge, n\-s

.TP
`
bridge, sw\-ne

.TP
 '
bridge, se\-nw

.TP
a
fence, se\-nw end

.TP
b
fence, nw\-se end

.TP
c
fence, ne\-sw end

.TP
d
fence, sw\-ne end

.TP
e
fence, n\-s

.TP
f
fence, sw\-ne

.TP
g
fence, nw\-se

.TP
h
fence, nw\-s

.TP
i
fence, ne\-s

.TP
j
fence, sw\-n

.TP
l
fence, se\-n

.TP
m
fence, nw\-ne

.TP
p
fence, sw\-se

.PP
There is also an alternative format\&. If the section is called map\-raw instead, the map is defined by giving the hexagon identifiers directly, using the comma as a tile separator\&. This approach requires intimate knowledge of the tileset used and may break the map if the tileset changes\&. The format has been created because there are now more tiles than can be represented with single ASCII characters\&.

.SS "player"

.PP
This can be used to set some player definitions\&. There may be a maximum of two player sections in a file\&. The first section encountered corresponds to the first player, the next to the second\&. Valid qualifiers are

.TP
name
player name\&. If omitted this defaults to 'Player 1' or 'Player 2', depending on the position in the file\&. (maximum length 15 characters)

.TP
briefing
index of the player's briefing message\&. The briefing can be reviewed during the game by choosing the Briefing item from the Game Menu\&. It is also recommended to create a message event to tell the players about their objectives on the first turn (see event and messages sections below)\&. If omitted defaults to \-1, meaning that no briefing is available\&.

.SS "unit"

.PP
Each of these sections creates a unit on the map\&. Loaded transporter units must be specified before any units they carry\&. Valid qualifiers for units are

.TP
xpos, ypos
location of the unit on the map\&. If there is a building at the given location, the unit will be put in\&. It is also possible to let units begin inside a transport\&. In that case you have to make sure, however, that in the level file the transport is declared before the carried unit\&. (mandatory)

.TP
id
unique unit identifier [0\-10000]\&. (mandatory)

.TP
type
unit type definition to use for this unit\&. Known definitions for the default unit set are Infantry, Medium Tanks, Heavy Tanks, Anti\-Aircraft Tanks, Anti\-Aircraft Guns, Artillery, Mines, Patrol Boats, Fighter Squadron, Personnel Carriers, Troopships, Transport Planes, Scouts, Interceptors, Bunkers, Torpedo Boats, Bomber Wing, Hovercraft, Gunships, Troop Train, Rail Guns, Armoured Train, Submarines, and Aircraft Carriers\&. (mandatory)

.TP
player
unit controller [1|2]\&. (mandatory)

.TP
face
direction the unit is heading [0\-5]\&. Directions are numbered clockwise from North (0) to Northwest (5)\&. Defaults are North (0) for units controlled by player 1, and South (3) for the second player\&.

.TP
crystals
amount of crystals the unit carries\&. This may only be given for transports and defaults to 0\&.

.SS "building"

.PP
A building section is required to actually create a building (sometimes also called a shop) on the map that units can enter\&. This is not automatically done by placing the symbol for a building entrance in the map section\&.

.TP
xpos, ypos
location of the building entrance on the map\&. (mandatory)

.TP
id
unique building identifier [0\-10000]\&. (mandatory)

.TP
player
building controller [1|2|0]\&. Units starting in unaligned buildings are automatically tagged unaligned as well\&. (mandatory)

.TP
type
type of building\&. Units can be repaired in buildings of type Workshop\&. New units can be produced in buildings of type Factory\&. A building may have multiple types\&. Defaults to Depot, meaning no special attributes\&. In addition to these attributes, a shop which produces crystals is (automatically) called a Mine\&.

.TP
name
building name (maximum length 20 characters)\&. Default value corresponds to building type\&.

.TP
mining
amount of crystals produced each turn [0\-1000]\&. Defaults to 0\&. If given, implies type Mine\&.

.TP
capacity
maximum amount of crystals [0\-10000]\&. Defaults to 1000\&.

.TP
crystals
amount of crystals in stock [0\-capacity]\&. Defaults to 0\&.

.TP
factory
name of a unit type definition that can be built here\&. If given, implies type = factory\&. Multiple factory lines may be given for a shop\&.

.TP
minweight
weight of the smallest unit allowed to enter the building [0\-99]\&. Defaults to 0\&.

.TP
maxweight
weight of the heaviest unit allowed to enter the building [0\-99]\&. Defaults to 99\&.

.SS "event"

.PP
Events provide a way to interact with players during a game\&. They can cause actions like points being awarded or messages being displayed under certain conditions\&. The event type defines what happens, the event trigger controls when (or if) the event is executed\&.

.PP

Event Types
.TP
createunit
create a unit in a building\&. The unit will only be created if the specified building is controlled by the player for whom the event is set up\&.

.TP
manipulateevent
modify event internals\&. Currently this can be used to dynamically enable or disable an event\&.

.TP
message
display a message\&.

.TP
mining
set the amount of crystals for a building\&.

.TP
nextmap
change the setting for the next map to be played\&. Can be used to create dynamic campaigns\&.

.TP
research
make a new unit type available for production in a factory\&.

.TP
score
award points to a player\&.


.PP

Event Triggers
.TP
havebuilding
the event is executed when the player controls a certain building on a specified turn\&.

.TP
haveunit
the event is executed when the player controls a certain unit on a specified turn\&.

.TP
turn
the event is unconditionally executed on the specified turn\&.

.TP
unitdestroyed
the event is executed when a specified unit is destroyed or captured by the enemy\&.

.TP
unitposition
the event is executed when a specified unit ends its move on a certain target hex\&.


.PP
The following list contains generic qualifiers which are valid for all event types\&.

.PP

Qualifiers
.TP
id
unique event identifier [0\-200]\&. (mandatory)

.TP
type
event type (mandatory, see below)\&.

.TP
trigger
event trigger (mandatory)\&. This describes the circumstances under which the event is executed (see below)\&.

.TP
message
index of a message to be displayed when the event occurs\&.

.TP
title
title of the message window\&. Only useful when a message is shown\&.

.TP
depend
identifier of another event\&. This makes the current event depend on the given event\&. Prior to event execution, the trigger conditions for both events are checked, and the event is activated only if both are successful\&. Mutual, circular, and transitive dependencies are supported\&.


.PP
In addition there are special qualifiers which can only be used with certain event types or triggers\&. All of these are mandatory if nothing else is stated\&.

.TP
action (manipulateevent, mining)
For manipulateevent this defines how to handle the specified flags\&. A value of 0 will set, 1 will clear, and 2 will toggle the flags\&. For mining 0 will set the crystal storage to an absolute amount, 1 will modify the current amount by the given number, 2 will set the mining rate, i\&.e\&. the amount mined each turn, and 3 will change the current mining rate by the given value\&. Minimum mining rate is 0, maximum is 200\&.

.TP
building (createunit, mining, research)
Identifier of the building referenced in the event\&.

.TP
crystals (mining)
Amount of crystals\&. The action flag controls how this number is actually interpreted\&.

.TP
event (manipulateevent)
Identifier of the event to be modified\&.

.TP
flags (manipulateevent)
Event flags to be modified\&. Currently the only legal value for this is 1, the disable flag, which can be used to deactivate an event\&. Disabled events won't be triggered even if their trigger conditions are met\&.

.TP
map (nextmap)
For this event you must create a message in the messages section which contains the name of the map to be loaded (excluding file path and suffix)\&. The event then needs to know the message identifier\&.

.TP
success (score)
Amount of success points the player receives when the event occurs\&. Any player with a success score of 100 or more wins the game\&.

.TP
unit (createunit, research)
Name of a unit type specification to build or make available, respectively\&.

.TP
tbuilding (havebuilding)
Identifier of the building to be controlled\&.

.TP
towner (havebuilding, haveunit, unitdestroyed)
The event will only occur if the new owner of the building or unit is the same as the player specified here [1|2]\&. For the unitdestroyed trigger it is only required if tunit is \-1\&. In this case you can select the player whose units have to be destroyed to activate the event\&. This setting may be omitted and defaults to the player not owning the event otherwise\&. You must supply this key for the other two trigger types\&.

.TP
tturn (havebuilding, haveunit, turn)
Turn on which the event conditions should be checked\&. For turn the event will always be executed on this turn\&. (mandatory only for turn\&. If omitted for the other triggers, the condition will be checked each turn\&.)

.TP
tunit (haveunit, unitdestroyed, unitposition)
Identifier of the unit to be targeted\&. For unitdestroyed and unitposition this may take a value of \-1 which will activate the event when all enemy units have been destroyed or any unit controlled by this player has reached the destination hex, respectively\&.

.TP
txpos, typos (unitposition)
Coordinates of the target hex

.SS "messages"

.PP
The messages section contains all text messages that may possibly be displayed in the course of a mission\&. The format of this section differs from that of the other sections\&. Here is an excerpt from an imaginary level file\&.

.nf

[messages]
This is a message\&.
% this line separates messages
This is the second message\&.
% separator lines can be used for comments
This is the third message,
containing a line break\&.
%% this marks the end of the messages section
  
.fi

.PP
A single message may be up to 1800 characters long\&.

.SH "EXAMPLE"

.nf

### This is a simple example mission file

[mission]
title = Example
mapwidth = 11
mapheight = 10
# the first message in the [messages] section
# will be used as level information
info = 0
# we use the default tileset and unit set so we could
# omit the next two lines
tileset = default
unitset = default

[map]
***\&.\&.\&.***\&.\&.
**\&.\&.\&.****\&.=
*<^1n]*\&.\&.==
**v\&.\&.(\&.\&.==~
***\&.\&.\&.]\&.=~~
#=#\&.==!====
======(]\&.\&.\&.
%*\&.=\&.\&.\&.E^>\&.
%%\&.\&.%\&.\&.\&.v\&.\&.
%%%%\&.%\&.\&.\&.**


### first player
[player]
name = The Good
# second message is briefing for this player
briefing = 1

### second player
[player]
name = The Bad
# third message is briefing for this player
briefing = 2


### units for player 1

[unit]
# this unit will start in the building
xpos = 3
ypos = 2
player = 1
id = 0
type = infantry

[unit]
xpos = 5
ypos = 4
player = 1
id = 1
type = medium tanks

[unit]
xpos = 6
ypos = 3
player = 1
id = 2
type = medium tanks

[unit]
xpos = 3
ypos = 2
player = 1
id = 3
type = scouts


### units for player 2

[unit]
xpos = 7
ypos = 7
player = 2
id = 10
type = anti\-aircraft tanks

[unit]
xpos = 6
ypos = 6
player = 2
id = 11
type = personnel carriers

[unit]
xpos = 7
ypos = 6
player = 2
id = 12
type = infantry

[unit]
xpos = 7
ypos = 7
player = 2
id = 13
type = heavy tanks


### buildings

[building]
name = HQ of the Good
xpos = 3
ypos = 2
id = 0
player = 1
# can repair units here
type = workshop
crystals = 25

[building]
name = HQ of the Bad
xpos = 7
ypos = 7
id = 1
player = 2
# can repair and build units
type = workshop
type = factory
# the following units can be built
factory = personnel carriers
factory = anti\-aircraft guns
factory = bomber wing
crystals = 25

### events

# player 1 wins if he conquers
# the enemy building at any time\&.\&.\&.
[event]
type = score
id = 0
player = 1
trigger = havebuilding
tbuilding = 1
towner = 1
# the next line could be left out
tturn = \-1
success = 100
message = 3
title = 4

# \&.\&.\&.or destroys all enemy units
[event]
type = score
id = 1
player = 1
trigger = unitdestroyed
tunit = \-1
success = 100


# player 2 wins if he conquers
# the enemy building at any time\&.\&.\&.
[event]
type = score
id = 2
player = 2
trigger = havebuilding
tbuilding = 0
towner = 2
success = 100
message = 3
title = 4

# \&.\&.\&.or destroys all enemy units as well
[event]
type = score
id = 3
player = 2
trigger = unitdestroyed
tunit = \-1
success = 100

# display briefings on first turn
#
[event]
type = message
id = 4
player = 1
trigger = turn
tturn = 1
title = 5
message = 1

[event]
type = message
id = 5
player = 2
trigger = turn
tturn = 1
title = 5
message = 2


### messages

[messages]
The Great Example
Revision 3 (27\-09\-2002)
by Jens Granseuer <jensgr@gmx\&.net>
%
This is a nice introductory message, so that player 1 knows what he is expected to do\&. Word wraps are done automatically, so don't include line breaks if you don't want them\&. So, Player 1, let's take them apart:

Either conquer the enemy headquarters or destroy all their troops\&.
%
This should present the situation to player 2\&.

You are being attacked\&. Defend yourself\&. The attack is considered repelled if you gain control of the enemy headquarters or the entire attacking army is no more\&.
%
This is the success message for conquering the enemy headquarters\&.
Congratulations!
%
Hip! Hip! Hurrah!
%
The Great Example
%%

.fi

.SH "NOTES"

.PP
The file format of level files (source and data) is subject to change without notice\&. If you get an error " File not of the required type", it mostly should be sufficient to feed the appropriate source file to \fBcfed\fR again to create a valid level file\&. However, no promises are being made\&. You have been warned!

.PP
\fBcfed\fR will eventually be phased out in favour of \fBCoMET\fR, the graphical map editor for \fBcrimson\fR\&.

.SH "SEE ALSO"

.PP
 \fBcrimson\fR(6), \fBbi2cf\fR(6) 

.SH "COPYRIGHT"

.PP
Copyright © 2000\-2003 Jens Granseuer

.PP
This software is distributed under the terms of the GNU General Public License: \fIhttp://www.gnu.org/copyleft/gpl.html\fR (GPL)\&.

.SH AUTHOR
Jens Granseuer.
