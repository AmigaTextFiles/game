		Empfe, a front end for Amiga Empire.
		====================================


Empfe V2.0, © Copyright 1989, 1990 by Håkan Thörngren.
This software may be distributed for NON-PROFIT only. This software is
freeware, not shareware.

You must distribute ALL files described under CONTENTS together. You are
allowed to take a minor fee when distributing Empfe to cover media and
mailing costs. You are NOT allowed to make ANY kind of profit from Empfe.


  Håkan Thörngren
  Rackarbergsgatan 44:214
  S-752 32 Uppsala
  Sweden

Source is NOT available at the moment, but the latest executable is:
1. By normal mail, send me a disk and enough to cover the return postage,
   use international mail coupons.
2. At a local BBS in Uppsala (Sweden):  (THIS IS NOT VALID AT THE MOMENT!!!)
   AmigaLink:  +46 18421320
   Moonlight: +46 18551878



  Mail bug reports, suggestions and donations to:
    - By email to hakant@kuling.docs.uu.se
    - By normal mail at my home address.
    - By local email at some BBS that I am on.
    - By mail to H}kan Th|rngren at FidoNet node 2:206/101.6
      (use netmail and keep it short)


Donations are welcome I guess, but not solicited. If you do get lots of fun
from Empfe and feel that you have money to give away, feel free to send me a
donation. I cannot promise anything in return. If you happen to have an
A2630 board to give away, I need it.:-) (Empfe takes its time to compile
with Lattice C....)

You may consider sending a donation to Chris Gray, for writing Amiga
Empire instead. I just wrote Empfe because I needed it, and wanted
something to do with my Amiga.



			   INTRODUCTION

Empfe is an intuition based client for Amiga Empire. You may run Empfe
over the serial port or as a local client with Amiga Empire 2.x.
Empfe keeps its own database in memory at all times, and tries to keep
everything you know about the world right at your fingertips. This database
contains the sectors and ships you have found, as well as all the countries.

If you are not familiar with Amiga Empire, read the documentation file(s)
for it before trying to use EmpFE. Empire documentation may be distributed
with this package or you may find version 2.1w on Fish disk #329 and Empire
1.0 on Fish disk #118.

This version of Empfe should work with Amiga Empire version 2.x as well
as earlier 1.x versions. It will NOT work properly in some versions of Amiga
Empire by Chris Gray that don't print the country number in the "country"
command output. You may get around this by using an ARexx macro
"set_country.rexx".

Empfe should work with all sizes of Empire worlds, even though you'll need
lots of memory to play a 256x256 game.


			      CREDITS

- Chris Gray for writing Amiga Empire in the first place.
- Chris Gray for writing Amiga Empire 2.0 which allows me to test Empfe
  without using the serial port!
- David Wright for testing Empfe, for adding features to Empire and
  distributing Empire and Empfe.
- Lattice C 5.05, many thanks to the CodeProbe debugger and the many useful
  error messages from the compiler.
- William S. Hawes, for ARexx and WShell. ARexx is a great companion.
  You'll add one or two more dimensions to Empfe by using ARexx.
- Mårten Norman for several bug reports and suggestions.
- Ken Nosé for the new and better graphics.
- PowerWindows, for saving me weeks of hacking intuition structures and
  testing it all out.
- Tim Kemp, for the program ILBM2C which I used to get all the brushes into
  C source code.
- The Amiga Replacement Project for a nice file requester.
- My Amiga for working fine and keep chewing all the source without giving
  up. The poor 68000 gets heavily loaded from time to time...
- Christopher A. Wichura for many useful suggestions and bug reports.


			   OVERVIEW

Consult the changes file, if available, for revisions. Empfe was designed
to make life easier for the Amiga Empire player. Using Empfe can make the
game unfair for those who don't have it.

  Here is a quick list of some features:

    - Scrollable map window with bitmapped graphics.

    - Auto dialer.

    - Internal database. You may quickly inspect your sectors and ships
      without asking the Empire host for the information. You may inspect
      everything without being connected to the host.

    - No need to remember all those sector coordinates, just press the
      shift key and click the sector to send it to the host.

    - Use the Empfe command gadgets to quickly enter common commands
      to the host.

    - ARexx support! You may kick off ARexx macros to execute in the
      background. These macros may peer into the database and issue
      commands to Empire.

    - Title bar statistics shows you where you are in the map, if
      you are logging everything to a file, if the dialer is trying to
      connect, if you are connected, and more.

    - You may run Empfe as a local client with Empire version 2.x.

    - Powerful path finder from ARexx.

    - Logical expressions to mark sectors and ships. Use them from the
      keyboard or inside ARexx macros.

    - Powerful scanner, Empfe extracts most information from the output
      of Empire automatically.


			  SYSTEM REQUIREMENTS

You will need an Amiga with at least 512k of internal memory to use the
program at all. Empfe should work with AmigaOS 1.2 and 1.3, but it will
break under older AmigaDOS 2.0 (green alert).

There should soon be a new AmigaOS 2.0 around that will allow Empfe to
run again.

You should set the stack to at least 6000 bytes when running Empfe, but
it will probably work well if you have at least 4000 bytes. I haven't tested
stack usage for a while, but I do try to keep it down.

Always be sure that there is enough room on the disk you save the sectors on,
(Empfe always tries to keep a backup) and that you have room for your
logfile(s).

The following table will give you a hint of how much memory you'll need.
The numbers are based on my own thinking; I have NOT actually tested how much
memory Empfe needs.

512k	    16x16 32x32 and maybe 64x64, but you will probably have to
	    the squeeze the last bytes from your system to run
	    a full 64x64 game.
1meg	    Everything up to 128x128 should work.
3meg	    All world sizes up to 256x256.

You'll note that you probably should have (at least) 1 megabyte of memory to
feel safe with worlds larger than 32x32.



				 CONTENTS

  The following files should be included when you get this archive:

Empfe		     The executable.
Empfe.doc	     Documentation (this file).
README		     Some quick notes for first time users who don't like
		     large docs..
arp.library	     The ARP library, needed.
CopyLib 	     Script file that will copy arp.library.
CopyLib.info	     Icon for CopyLib.
Empfe.init	     Sample initialization file for CLI users.
Empfe.sectors	     Sample sector file.
Empfe.changes	     Changes file for Empire. Consult this file if you have
		     gotten an update, may be missing.
Empfe.info	     Empfe tool icon.
Interlace.info	     Project icon.
rexx/snoop.empfe     Rexx macro for snooping out the world.
rexx/cspread.empfe   Rexx macro for spreading out civilians.
rexx/mspread.empfe   Rexx macro for spreading out militaries.
rexx/LoginCmds.empfe Simple Rexx login file.
rexx/stupid.empfe    Rexx macro that will point out bad spots in your
		     country.
rexx/long_nav.empfe  Macro that will queue a ship or fleet for long
		     navigation.
rexx/long_nav_handler.empfe
		     Macro that will perform the long navigations.
rexx/Empfe_log.empfe
		     Macro that will print an entry to a logfile.
rexx/macros.empfe    Rexx macro that will print out all executing macros.
rexx/print_map.empfe
		     Simple Rexx macro that will print out a map on the screen.
rexx/set_country.rexx
		     Use this Rexx macro to set all country names if Empire
		     fails to give you country numbers in the country report.
rexx/DialGetty.rexx  Rexx macro that will call and login a game running
		     under Getty.


		    MANUAL INSTALLATION OF EMPFE

1. Copy libs/arp.library to your LIBS: directory if you are not already
   running Arp.

2. Copy the file Empfe.init to your S: directory and edit it to match
   your requirements. You may place this file elsewhere or name it whatever
   you want, but then you must tell Empfe where to find it.

3. Set at least WorldWidth, WorldHeight, Country, and Password in the init
   file.

NOTE: You won't need the init file if you are running Empfe from the
      Workbench - just edit the variables in the Tool Types of the icon
      you plan to use.



	     AUTOMATIC INSTALLATION OF EMPFE (for Workbench users)

1 Double click the CopyLib icon or type 'execute CopyLib' from the
  CLI if you are not already running ARP!

2 Go to the section GETTING STARTED below.


		    COMMAND LINE OPTIONS

  For CLI users:

  Empfe inspects the command line given to it and knows about the
following flags. File names specified by flags will override the names
given in the init file.

    -h		Will list the known flags.

    -lfilename	Use this file as log file. Everything that Amiga Empire
		sends will be put into this file. Default file is
		Empire:Empfe.logfile.

    -ifilename	Read this init file instead of S:Empfe.init. There
		are lots of variables declared in this file.

    -dfilename	Use this file as database file. Default file is
		Empire:Empfe.sectors.

    -Pfilename	Read this file and parse everything in it. Data will
		be added to the database and written to disk.
		Useful for rebuilding your database if bugs in Empfe
		have ruined it, or if you get Empfe when you have been playing
		Empire for a while. Always keep your logfiles!
		Beware! Empfe cannot parse the file properly if you
		have moved your capital.

    -Cnn	Use this country number as the owner of the logfile to be
		read in. If you don't set this owner, the owner will be
		assumed to be you.

    -Xnn	Use this column offset as the column coordinate for the
		capital in the logfile. (default=0)

    -Ynn	Use this row offset as the row coordinate for the capital
		in the logfile.

    -Mname	This will cause the ARexx macro named 'name' to be
		executed.

    -Q		This will save the database and quit Empfe as soon as no
		ARexx macros are executing.

    -a		Autodial Empire immediately.

    -V		Verbose mode, useful for debugging or for pure fun..

    -Hn 	Connect to host, n=0:local host, n=1:serial host (default),
		n=2: no host.


You will probably want to specify the log file and the database file
in the init file.



			    GETTING STARTED

  From the Workbench:

Edit the tool types for the Empfe icon or make your own project icon
and edit its tool types. The commands you can enter as tool types will
be described under EMPFE COMMANDS AND VARIABLES below.

NOTE: There is a new tool type INITFILE=filename which will read the
initfile for commands.

  From a CLI (or shell):

The first thing you should do if you are getting started with Empfe is
to carefully edit the init file.

You may also want to make an alias with your options added to the command
line if you're using a shell.


  For both workbench and CLI users:

The most important is to set your country name, the size of the world and
where to find the data files. These variables are WorldWidth , WorldHeight,
Country and Password.

Don't use the sector file that comes with Empfe. It is included so that
people can play with Empfe without calling an Empire host.

When you have connected to Amiga Empire for the first time (with a blank
database), the first thing you should do is a COUNTRY command. This will
cause Empfe to read in all countries and find out which country number you
are.

Examine the country line, it MUST have the country numbers included.
Empire 2.x by Chris Gray has a flag for this, so if the numbers are missing,
ask the deity nicely if he can turn it on. (There is a known bug with this in
early 2.x versions, please read the section 'EMPIRE VERSIONS AND PITFALLS'.)

If you are running with an Empire version older than 2.0 by Chris Gray
and you own ARexx, you can use ARexx to convert country names to numbers.
A macro named "set_country.rexx" has been included for this purpose.

The next thing you should do is to make a map around your country. Refer
to the Amiga Empire manual for this. Then do a "dump" or "census" of your
sectors.

You should keep a hard copy of this manual and the Amiga Empire manual
available when you are playing and read them carefully before trying anything.

Keeping logfiles of the entire game is a very good idea. Just be prepared
with a couple of blank floppy disks to keep them on. This will let you
go back and examine everything that has happened to you in the game.
Another good reason for keeping all the logfiles is that you can rebuild
the entire database in Empfe from them. This may be needed if a nasty
bug in Empfe shows up and screws up your database.

Empfe will not overwrite a logfile, just append new data to it.

It is recommended that you dump all sectors every now and then, and
not trust the auto dumper in Empfe completely.


		   EMPFE COMMANDS AND VARIABLES

You add commands in the tool types if you run Empfe from the Workbench,
or in the init file if you run Empfe from a CLI.

The only allowed command at the moment is 'set'.

It has the following syntax:
set VAR VALUE

It will set the variable VAR to VALUE. There are several (many) variables you
can set by this command and you can actually tune Empfe with them.

All the variables Empfe knows about are listed below.

Name		Type	Comments
==========================================================================
WorldWidth	integer The horizontal size of the world. (default 64)

WorldHeight	integer The vertical size of the world (default 64)

Country 	string	Your country name. You MUST give this.

Password	string	Your password.

Logfile 	string	Log everything that Amiga Empire sends to this
		file.

Sectorfile	string	Database file. This file contains much more
			than just sectors.

DialDelay	integer How many seconds to wait before trying again
			if the dial failed. (default 10 seconds)

DialWait	integer How many seconds to wait for a connect after
			dialing. (default 30 seconds)

Number		string	The number to dial. If you have more than one
			number to dial, separate then with a '$'.
			Example:  set Number 101010$202256$90000

Attempts	integer Number of attempts to dial before giving up.
			0 is infinite. (default 0)

TryTime 	integer Number of MINUTES to try before giving up.
			(default 35 (minutes))

DialPrefix	string	The dialer will take this string, append
			the phone number and a carriage return and
			send everything to the modem to dial. (default ATDT)

DoLogging	boolean 1 if you want to start Empfe with logging
			enabled, 0 if you don't. (default 1)

Baud		integer Baud rate to be used. (default 2400)

SerialDevice	string	Serial device name. (default serial.device)

Unit		integer Serial device unit number to be used.
			(default 0)

PrinterDevice	string	Printer device for printing data. (default prt:)

SerialParameters string
			Serial parameter declaration. (default 1FN8).
			0,1,2 stands for number of stop-bits
			7,8 stands for number of data-bits
			F  stands for full duplex - ignored
			N is no parity
			E is even parity
			O is odd parity

ReadBufferSize	integer Size of the serial read buffer in bytes.
			(default 16000)

RowMultiply	integer Distance to move the cursor vertically when
			the shift key is pressed. (default 10)

ColMultiply	integer Distance to move the cursor horizontally when
			the shift key is pressed. (default 10)

Login		boolean 1 if you want Empfe to log in automatically when
			the auto dialer succeeds. (default 0)

LoginWait	integer This variable sets the number of seconds between
			each carriage return when Empfe is trying to
			log in. Default is 8 seconds. If the login fails,
			try increasing this variable.

DelayedCommandWait integer
			Number of seconds/10 to wait between each delayed
			command. Default is 5 (=0.5 seconds).

HideDelayedCommands boolean
			If set to 1, Empfe will try to hide all delayed
			commands for you. This mean that you will not
			see them at all.

DoUpdate	boolean If set to 1, Empfe will update your database
			automatically for you (using delayed commands)
			when the automatic login procedure succeeds.

TimeOutQuit	integer Number of seconds to wait before sending "bye"
			and SAVEQUIT Empfe. This may be needed if you
			forget to log out or if ARexx is running Empfe
			and something goes wrong when no human is
			at the keyboard. Default 360 seconds.

TimeOutReturn	integer Number of seconds to wait before sending a
			carriage return to Empire. This may be needed
			if ARexx is running Empfe and the characters
			that build up the prompt are lost.
			Default is 60 seconds.

SetBlocksDirty	boolean If set to 1, this will cause all sectors in a
			block (ctrl/alt mouse click) to be marked dirty.
			Empfe will then try to auto dump all the sectors to
			get them clean again.
			Think twice before setting this to 1.
			Default is 0.

LogfileBufferSize integer
			Number of characters to buffer before writing
			to the logfile. Default 8192 characters.

Interlace	boolean If set to 1, Empfe will try to open an
			interlaced display.

MaxPathLength	integer This is the maximum allowed length for a path
			generated by the path finder. (default 512)

AutoMapping	boolean If this variable is set Empfe will try to do local
			maps when there are unknown sectors around any
			sector you own. This is a very nice feature, but
			it EATS BTUs. (default 0)

AutoCheckPoint	boolean This flag controls whether Empfe will try to help
			you with checkpoint codes. (default 1)

InfoLinesToKeep integer This is the number of lines Empfe will keep
			in the virtual info window. (default 20)

PathPri 	integer This is the path task priority Empfe will use
			relative to its own priority. In other words,
			this number is added to Empfe's priority and
			that number is used as the priority for each
			path finder task. (default 0)

ShiftBSDel	boolean This flag controls whether Empfe will shift the
			function for the <- and DEL keys. (default 0)

UseHost 	integer This is the number of the host to be used.
			0=local (running Empfe on the same machine as the
			Empire server), 1=serial, 2=none. (default 1)

ARexxLogin	string	This macro will be called every time auto login
			succeeds. (default LoginCmds.empfe)

ARexxStartup	string	This macro is called every time Empfe starts.
			(default startup.empfe)

MaxMapWindowSize integer
			This is the size of the map window numbered
			as vertical sectors. You can free some memory
			by fiddling with this number.
			(default 0, which is as large as the screen)
DropDTR 	boolean
			Empfe will drop the DTR rather than sending +++ATH
			to hang up the connection if this variable is set
			to 1. Default is 0 (+++ATH).

Serial7Wire	boolean Use real hardware handshake if set to 1, default
			is 0, which should use the serial settings from
			preferences.

DelayedCommandColor integer
			The pen color for delayed command issued by ARexx.
			(default 1 (white))

HideDelayedCommandsFromARexx boolean
			A boolean variable that tells whether Empfe will
			display delayed commands for ARexx or not.
			If you set this variable to 1 (TRUE) and the variable
			HideDelayedCommads 0 (FALSE), you will see delayed
			commands issued by ARexx as well.
			(default 0)

ScreenToFrontWhenConnected boolean
			If set to 1, Empfe will bring the screen to front
			when the auto dialer succeeds.
			(default 0)


			       THE MENUS

This section lists all menus and tries to explain what they do.
You will probably find that most of them are rather intuitive and you
will probably know what they do without having to read it here.


Project

  About..  Will tell you which version of Empfe you are running and
	   some other information.

  Load	   Load a new database file. You must confirm that you want
	   to clear the old database in memory. If you don't, no load will
	   be done. If you have made changes to the database you must
	   save it before loading another. If you have done something
	   really foolish and don't want to save the database, use
	   Quit(No Save) and restart everything again.

  Save	   Saves the current database. You will get a backup of the
	   previous database, if it exists. This backup will have a ~
	   appended to it.

  Logfile

    DoLogging	Boolean flag. If set, everything that comes from the serial
	   port when there is a carrier detected will be written to the
	   logfile.

    Change File Change the logfile. Prompts with an Arp file requester
	   and changes the logfile to the selected file. The old logfile
	   will be closed if it was open.
  Print

    Map    Prints out the entire map on the selected printer device.
	   This is a rather simple and unintelligent piece of code,
	   but it is the only way to have a hard copy of the sectors.

    Your Ships	  Prints out all your ships on the selected printer device.
	   Very similar to the Empire command SHIPS.

    Other Ships   Prints out all ships Empfe knows about that you DON'T own.

  Host

   Local   Opens a connection to an local Empire host running on the same
	   machine as Empfe.

   Serial  Opens the serial device and allows you to dial to a
	   remote Empire.

   None    Use no host at all. Empfe is disconnected from any host you were
	   talking to when you select this option.

  Quit (No save) Will quit Empfe without saving any changes to the
	   database.

  SaveQuit    Save all changes to the database and quit Empfe.


Edit

  Sector

    Designation    Change sector designations and enter new sectors directly
	   into the database.

    Owner  Set the owner of a sector.

    Forget Delete a sector.

  Ship

    Owner  Set the owner of a ship.

    Sunk!  Sinks a ship in the Empfe database. This function will only set a
	   flag, you must use Forget to actually delete a ship.
	   Already sunken ships (but not deleted) can be brought to life
	   again with this command.

    Position  Set the position of a ship. You may enter new ships into
	   the database with this command too.

    Forget Delete a ship.

    Name   Set the name of a ship. This name will show up when you
	   examine the ship.


Set

  HighLight    Enter a highlight string. More on this later.

  Info header  Toggle the header of the info window between sectors and
	   ships. The info window is where you examine sectors
	   and ships, just click a valid sector to open it.

  Origin   Set the position of the current capital. If you change the
	   capital of your country the coordinate system will change,
	   and use this new capital as the origin.
	   IT IS VERY IMPORTANT TO USE THIS COMMAND WHEN YOU CHANGE
	   THE CAPITAL, AND ONLY IN THIS CASE!!!!
	   If you fail to do this, Empfe and Empire will use different
	   coordinate systems and this *will* screw up your database!!!

  Mines    Toggle mines in a sector. You can use this to get a graphic
	   indication of a sector that you know or believe to have
	   mines.

  Next ship   Takes you to the next ship. Useful if you have lots of ships
	   spread around the world. Will not keep returning to a big fleet all
	   the time.

  Alt Origin Set the alternative origin. You must also turn on a flag
	   in the Preferences menu to see alternative coordinates.
	   They will appear as (X,Y) in the map header when active.

  Position Find a sector by its coordinate, a ship by its number or
	   its associated name, or a fleet by its fleet character.



Show

  Delivery

    Civilians.....Gold Bars
	   This will bring up delivery arrows for the selected item.

  Defenders   This will bring up defender arrows. Arrows will show up
	   in sectors that are defended and the direction will show
	   where the defender is coming from (pointing FROM the
	   defender INSIDE the DEFENDED sector).

  None	   Show no arrows at all.


Serial

  Baud

    300..9600	Set the baud rate. The current baud rate is marked.

  Parity

    None.. Set the parity. The current parity is marked.

  Databits

    7..8   Set the number of data bits. The current number is marked.

  Stopbits

    0..2   Set the number of stop bits. The current number is marked.

  Send break   Send a break over the serial port.

  MultiDial    Start the auto dialer.

  HangUp   Hang up the connection using '+++' 'ATH'.

  Stop dialing	 Stop the auto dialer.



ARexx

  Call Macro   Start executing an ARexx macro as a new process. The macro
	   will get the port for Empfe if it wants to issue commands
	   back. More on this later.

  Accept ARexx Commands
	   A flag that, if set, allows ARexx macros to issue commands
	   back to Empfe. If not set, Empfe will not answer any commands
	   from ARexx macros.


Misc

  Login    Try to login automatically.

  Send Password   Send your password and a return to the serial port.

  Expunge sunken ships
	   This option will remove all sunken ships from the database.


Preferences

  Show coordinates
	   Toggles the coordinates in the map window on and off. Not
	   very useful unless you want to see some info in the
	   map header that won't fit in the visible area with coord
	   display on. This may happen if lots of info is displayed
	   in the header.

  Show alt coordinates
	   Toggles the alternative coordinates in the map window on
	   and off. Alternative coordinates are useful when translating
	   coordinates between allied countries.

  Hide delayed commands
	   Toggles the hide delayed command flag. This command doesn't
	   take immediate effect, it will wait until the next prompt
	   is up before actually switching state.


			    MOUSE COMMANDS

There are several commands associated with the left mouse button and
qualifier keys on the keyboard. The listed commands below are only
valid inside the sector area in the map window.

Qualifier      Comments
=======================================================================
None	       A single mouse click without any keys pressed will
	       open the info window and display info for the sector
	       or ship, depending on the mode you are in.
	       Use the menu command "Set->Info header" to select the
	       mode and header type for the info window.

Shift	       Send the coordinate of the sector that you clicked.
	       Very useful!

Ctrl	       Store the clicked sector as the upper left corner for
	       a multi-sector send. See below.

Alt	       Use the clicked sector as the lower right corner for
	       a multi-sector send. It will send the multi-sectors as
	       toprow:bottomrow,leftcol:rightcol to the serial port.
	       Very useful if you want to specify more than one sector.
	       See the Amiga Empire manual for more information about this.
	       (see REALMS)

LeftAmiga      On some keyboard this is the "Commodore-key". This will
	       send the ship number for a ship in the sector if you have
	       first used the command gadgets, or if the ship is the only
	       one in the sector.
	       If you press the "NAVIGATE" gadget followed by LeftAmiga-
	       Click on a sector with a ship, this ship number will be
	       sent to the serial port. If this ship belongs to a fleet,
	       the fleet character will be sent instead.
	       This is also valid for RADAR and FIRE. If you are trying to
	       do a radar scan, Empfe will use the ship with the best radar
	       in the sector. In some cases Empfe will fail and not use the
	       best radar though....
	       Empfe does lots of checking on the ships to avoid using a
	       ship that, for example, doesn't belong to you, or doing a
	       radar scan with a damaged ship.



			  KEYBOARD COMMANDS

There are some useful commands that can only be issued on the keyboard.
Num-X stands for the numerical keypad key X. All special keys are
listed below:

Key	   Explanation
==========================================================================
HELP	   Toggles the terminal window to front and to back. Useful if
	   you want to see covered text. Much easier than using the depth
	   gadgets.

Arrows	   Each arrow will move the cursor in the map window one sector.
	   If you press SHIFT and then the arrow key, you will move
	   the cursor 10 sectors instead. The constant 10 may be changed
	   in the tool types or in the init file.

Num-1	   Send the string '/l<return>' to Empire.
Num-2	   Send the string 'd<return>' to Empire.
Num-3	   Send the string '\r<return>' to Empire.
Num-4	   Send the string 'l<return>' to Empire.
Num-6	   Send the string 'r<return>' to Empire.
Num-7	   Send the string '\l<return>' to Empire.
Num-8	   Send the string 'u<return>' to Empire,
Num-9	   Send the string '/r<return>' to Empire.

Num-5	   Send the string 'v<return>' to the Empire. Useful when you
	   are snooping on sectors from a plane or are moving over
	   unknown sectors.

Num-.	   Send the string 'b<return>' to Empire. Useful when want
	   to be nasty to the sector owner below (bomb him away!).



		  HIGHLIGHTING AND LOGICAL EXPRESSIONS

Highlighting sectors is a very useful feature of Empfe. For example, you
may want to see which sectors have enough civilians to be moved to
new sectors or you may want to see all gold mines that have run out of
gold.

Highlighting lets you do this and much, much, more.

You bring up a requester for a highlight string (using the menu or a
key) and enter the highlight string there. A list of items that can
be entered in the reqester is given below:


Logical operations:
===================
|    Or
&    And
!    Negation

Relation operators:
===================
=    Equal to
<    Less than
>    Greater than
!=   Not equal to
<=   Less than or equal
>=   Greater than or equal

Objects
=======
42     Numerical constant
h      Can be a designation character (harbour)
p      Can be a ship type (PT boat)
des    Designation (sectors only)
eff    Efficiency
mob    Mobility
civ    Civilians
mil    Military
plane  Planes
min    Mineral deposit
gold   Gold deposit
ore    Ore
bar    Gold bars
tech   Tech level (ships only)
type   Ship type
cont   Contracted (sectors only)
def    Defended (sectors only)
ship   Is a ship
prod   Production
me     I am the owner
shell  Shells
gun    Guns
own    Object owner (country number, -1=unknown)
day    The number of days since we last updated this sector/ship
backlog  Production backlog or ore ready to move
pb	   - " -
plague	 Plague in the sector

    Some clever examples will probably clear up most questions....

civ>64
  Mark all sectors and ships with more than 64 civilians.

eff<60 & ship
  Mark all ships with efficiency less than 60%, ie all ships that cannot sail.

gold<5 & des=g
  Mark all gold mines that are running out of gold.

gold>4 & des=g & mob>50
  Mark gold mines that probably have no delivery set.

cont & des=h
  Mark all contracted harbors.

mil<50 & (des = b | des = c)
  Mark all banks and capitals that may be poorly defended.

mil<50 & !def & (des = b | des = c)
  Same as above, but check for defending forts too.



			      AREXX SUPPORT

ARexx is a commercial product by William S. Hawes and you can probably
get it from your local software dealer.

ARexx is THE macro language for the Amiga as well as for Empfe.
You will add one or two dimensions to Empfe by using ARexx.

You can examine and affect the Empfe database from a macro, send commands
to Empire and do all sorts of clever things in the background while
YOU are doing the most important and fun things yourself. ARexx is a great
companion to Empfe while playing Empire!

Empfe defaults to the extension '.empfe' for ARexx-macros. But you
may use any extension you want. If you use some other name extension you
will need to spell out the entire name.

I will list just the functions that can be issued to Empfe by an ARexx macro.
Please refer to the ARexx manual (a good one) for more information on how to
write your own macros.

The ARexx interface has been changed with the 2.0 release of Empfe.
The reason for this was that I wanted more complete and powerful
commands. The old style command format tended to be overloaded.


			DATABASE FUNCTIONS

All database read and write functions make use of an ITEM. An ITEM
can be seen as a structure or class member. ITEMs were added so that
the number of function become few and it should be easier to memorize
them as many ITEMs are available in different objects.

The following is a list of all known items and where you can apply them.

ITEM	    sector    ship   country  sector	comments
				      flag
==========================================================================
civilian    yes       no      yes     no
military    yes       no      yes     no
efficiency  yes       yes     yes     no
gun	    yes       yes     yes     no
shell	    yes       yes     yes     no
plane	    yes       yes     yes     no
type	    yes       yes     no      no
mineral     yes       no      no      no
gold	    yes       no      no      no
mobility    yes       yes     no      no
ore	    yes       yes     no      no
bar	    yes       yes     yes     no
defended    no	      no      no      yes
dirty	    no	      no      no      yes  A sector with this flag set
					   is known to be updated in
					   Empire. Empfe will auto
					   dump the sector later on to
					   update the internal database.
mined	    no	      no      no      yes
contracted  no	      no      no      yes
tech	    no	      yes     no      no   Tech factor for ships.
					   The number is multiplied by
					   100.
owner	    yes       yes     no      no
fleet	    no	      yes     no      no
name	    no	      yes     yes     no
sector	    no	      no      yes     no
ship	    no	      no      yes     no
money	    no	      no      yes     no
status	    no	      no      yes     no
my	    yes       yes     yes     no
production  yes       no      no      no
crew	    no	      yes     no      no
power	    no	      no      yes     no
row	    no	      yes     no      no
column	    no	      yes     no      no
day	    yes       yes     yes     no
backlog     no	      no      no      yes
plague	    no	      no      no      yes
defender    yes       no      no      no
delivery_direction
	    yes       no      no      no
delivery_threshold
	    yes       no      no      no
checkpoint  yes       no      no      no


The following is a list of the known commodities.

civilian military shell gun plane ore bar


		     AREXX DATABASE FUNCTIONS

get_sector(ITEM, row, column)
  This function will return the value associated with ITEM for the given
  sector.

put_sector(ITEM, row, column, value)
  Set the given ITEM to value for the given sector. This is also a function
  and will return a value.

get_ship(ITEM, ship)
  Return the value associated with ITEM for the given ship number.

put_ship(ITEM, ship, value)
  Set the value associated with ITEM for the given ship to value.

get_country(ITEM, country)
  Return the value associated with ITEM for the given country number.

put_country(ITEM, country, value)
  Set the value associated with ITEM for the given country number to value.

get_sector_flag(ITEM, row, col)
  Return the value of the given flag (ITEM) for the given sector.

put_sector_flag(ITEM, row, col, value)
  Set the flag (ITEM) for the given sector to value. Valid flag values are
  0 and 1.

delete_sector(row, col)
  Deletes the given sector from the database.

delete_ship(ship)
  Deletes the given ship from the database.

Examples:
  say get_country('my') => 1    ;My country number, you only need the ITEM here
				; since you are asking for country number for my
				; country.

  say get_country('name', 1) => 'foo'
			    ; This command will return the country name for
			    ; country 1.

  say get_ship('name', 1) => 'Tirpitz'
			    ; This command will return the name for ship #1.

  say get_ship('crew', 1) => 10 ; Return the number of civilians of military
				; (depending on the ship type) for ship #1.

  say put_ship('name', 10, 'Evil') => 1
				; Set the name to evil for ship #10.

  say  get_sector('type', 0, 0) => 'c'
				; Get the sector type (designation) for 0,0
				; (probably your capital..)

  say set_sector_flag('dirty', 1, -2, 1) => 1
			    ; Set the sector flag 'dirty' for sector 1,-2
			    ; to 1. The sector will be treated as updated
			    ; by Empfe and will be auto dumped later on.

  say get_sector_flag('plague', 0, 0) => 1
			    ; Oops! Sector 0,0 has the PLAGUE!

Note 1: get_sector() and put_sector() have the commodity added after the
    column when you use the items delivery_direction and
    delivery_threshold.
    get_sector('delivery_threshold', 0, 0, 'ore') => 20
    put_sector('delivery_direction', 0, 0, 'ore', 1) => 1

Note 2: Directions for delivery are the same as used in Empire move.
	7    8	  9
	  \  |	/
	4  - 5 -  6
	  /  |	\
	1    2	  3

Note 3: Altered things in the database are only local to Empfe only. Empfe
    does not try to send these changes to the Empire host.


			AREXX MISC FUNCTIONS

max_ship()
  This function will return the highest ship number in the database.

max_country()
  This function will return the highest country number in the database

btu_left()
  Return the number of BTU's left. It's a good idea to monitor this if
  you are inside a loop that sends commands which use up BTUs to Empire to
  avoid completely using up your BTUs.

time_left()
  Return the number of minutes left before Empire will throw us out.

max_row()
  Return the world size in number of rows. This is the number of rows
  YOU have told Empfe with the user variable WorldHeight.

max_column()
  Return the world size in number of columns.

my_next_sector(row, col)
  Return my next sector. You can use this to loop around all your sectors.
  This function will return all your sectors in some undefined order.

my_next_ship(ship)
  Return my next ship number or -1 if ship was the highest.

out_fix_coordinate(row, col)
  Get the coordinate in a form that makes Empire happy.
  You MUST use this, since it takes care of such pitfalls as an altered
  origin!
  Example: out_fix_coordinate(5, 31) => 5,-1  (In a 32x32 world and origin at 0,0)

out_fix_block(upper_row, lower_row, left_col, right_col)
  Get the sector block in a way that makes Empire happy.
  Example: out_fix_block(0, 1, 2, 3) => 0:1,2:3

write_empfe_screen('text'[,color])
  Write the text to the Empfe terminal screen. You may give an optional
  color number if you want the text to be in another color than default.
  You can of course send screen control sequences if you want inside the
  text.

read_empfe_screen('text'[,color])
  Prompt the user with a string in the same format as write_empfe_screen()
  above.

get_running_functions()
  Will return a list with all running ARexx macros started from Empfe.
  If you have the macros 'foo' and 'bar' running you'll get the
  following response.
  "foo""bar"

empfe_run(COMMAND)
  Empfe will run the given COMMAND as an ARexx macro under Empfe. This is
  a nice way to spawn other ARexx macros from within a macro.

get_variable('var')
  Return the value of the given init variable.



			FUNCTIONS FOR POWER USERS

get_match(TIME,string1,..,stringx)
  Watch everything read for the substring stringi. If Empfe finds a match
  for string1 it will return 1. If it finds a match for the ith string,
  Empfe will return i. TIME is the number of seconds to wait before
  a time out in which case Empfe will return 0.
  Example: get_match(30, 'foo>', 'bar>') can return 0, 1 or 2.

find_path(row, col, max_dist, sea_flag, designation) or
find_path(row, col, max_dist, sea_flag, logical_expr) or
find_path(row, col, max_dist, sea_flag, end_row, end_col)
  Finds a path from a given sector at land if sea_flag=0 or at
  sea if sea_flag=1. Designation is a single designation character as
  destination.

  If sea_flag=2 you'll get a path in the air, this flag should really be
  called something else..

  Logical expression is an expression that's valid in the highlight
  requester. Any sector matching this expression can be the
  destination, very powerful, but has more overhead than the
  other two.

  Max_dist is the maximum destination, but _not_ expressed as number
  of sectors. Highways costs nothing, normal sector costs from 2 to 9.
  Enemy coast and minefields costs even more.

  The higher you set max_dist the longer will Empfe try to find the
  path. You can set this number high (10000 or so) to accept long paths.
  If you expect shorter paths, set a smaller number. Feel free to experiment
  with this number.

  Empfe will only allow paths through your own or checkpointed sectors
  on land. Empfe won't generate a path through a sector with plague.
  If Empfe fails to find the path, an empty string will be returned.
  A path find can take several seconds to run and Empfe will spawn a
  sub-task for it so that you can work even if a couple of macros
  are using find_path at the same time.

  Example find_path(5, -3, 500, 1, 'des=h&me') => 71333698214
  (Find my nearest harbor navigating from 5,-3).

convert_path(path)
  Will convert new style paths to old style paths. Previous Empire versions
  doesn't understand the paths generated by find_path(), this command fixes
  this problem.
  Example: convert_path('1234') =? '/ld\rl'

find_sectors(expression)
  Return a list of sectors matching the logical expression. If string
  gets too long, a '+' is added at the end.
  Example find_sectors('des=w&me') =>  '4,5 -5,3 2,-7'

find_ships(expression)
  Return a list of ships matching the logical expression. If string
  gets too long, a '+' is added at the end.
  Example find_ships('me') =>  '3 4 5 79 80'

get_map_line(upper_row, leftmost_column, downmost_row, rightmost_column,
	 flag, line_number)
  Will return a map line. If you start with line_number=0 and increment
  it after each line you'll get a complete map.
  When you fall off the edge you'll get 'done' from the function.
  The variable 'flag' handles what ships you want to see in the map:
    0 - No ships at all, plain map.
    1 - Include my ships.
    2 - Include all ships.
    3 - Include my ships and all allied ships.
    4 - Include all ships not owned by me.
    5 - Include allied ships.
    6 - Include ships owned by countries I'm at war with.
  Example: get_map_line(-2, 1, 1, 2, 2, 3) -> '-2 Bm -2'


find_ship_number(SHIP)
  Find the given ship and return its number or -1 if not found.
  Example: find_ship_number('a') => 4 (lowest in fleet 'a' is 4)
	   find_ship_number('Tirpitz') => 42
	   find_ship_number(2) => 2
	   find_ship_number('Y') => -1 (if no ship in this fleet)


		   AREXX DELAYED COMMAND SUPPORT

Refer to another place in this manual for a description of delayed commands.

do_command(command, priority)
  Add the given command to the delayed command queue at the given priority.
  This function will wait until Empire has processed the command and is
  back at the command prompt.

queue_command(command, priority)
  Add the given command to the delayed command queue at the given priority.
  This function will return quickly without waiting for the command to
  be executed by Empire.

queue_empty()
  This function will return 1 if the delayed command queue is empty and
  0 if there are any commands left in the queue.
  Don't busy wait on it! If you MUST wait, use it within a loop with
  delay().

Examples:
  call do_command('ship 1',0)   ; Wait until Empire has processed the command
				; ship 1.

  call queue_command('move c 0,0 10 6e',0)
			    ; Move some civilians from sector 0,0 to sector
			    ; 0,1.


			AREXX CONTROL FUNCTIONS

dial()
  Dial the Empire host and log in if you have enabled it (see user variables).

login()
  Log in to Empire.

connected()
  Return 1 if we are connected to the Empire host.

hang_up()
  Hang up ant serial connection.


!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Note: All functions return a value, it's an error _not_ to ask for the
value.
get_sector('type', 0, 0) will give an error.
a = get_sector('type', 0, 0) will work.
call get_sector('type', 0, 0) will work.
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!


			  FORWARDING

The command 'forward port' will allow you to monitor all lines read
from Empire. You open the port and pass it via 'forward' to Empfe.
Then monitor the port, every line will appear at this port, reply
quickly, Empfe will wait for a reply.

The command 'unforward port' will turn off forwarding, you may do
this by simply close the message port.

Example, assume that you have opened the port 'snoop'
address EMPFE forward 'snoop'
will instruct Empfe to forward everything to your port, then just
hang around waiting for stuff to appear.

It's possible to extend the parser this way by using the database
put_** commands.


There are also some other commands that you may send to Empfe. You specify
them by using 'command arguments', ie you put a single space between the
command and the arguments. Using these must be considered very risky
business!!!

Command 	Explanation
======================================================================
setc row,col	Sets the sector row,col as the capital, use with great
		care!!!
send string	Directly sends the string 'string' to the serial port.
		Can be very useful if you want to talk to the modem.
auto_dial	Start the auto dialer. No way to see when you are
		connected, yet...
parity p	Set the parity to p.
databits n	Set the number of data bits.
stopbits n	Set the number of stop bits.



			       INFO WINDOW

This window will display lines similar to the CENSUS and SHIPS line from
Amiga Empire. Some different information is displayed here too.

The sector/ship owner will be shown, ??? means that Empfe can't tell
the owner (issue a COUNTRY command to the host), 'me' means that this is
my stuff (you must set your country name in the init file, 'XYZ' is the
first 3 letters of the country name and if some country name are ambiguous,
then the country number will be displayed.

Sectors and ships are completely separated in Empfe 2.0. You can switch
between them with the menu option Set->Info->Header.

Sectors have some flags:
  O  - The sector need to be updated. This will be set if the sector is
       affected by a move command. Delayed commands will dump this
       sector later on.
  $  - Contracted sector.
  *  - Defended sector.
  %  - Checkpointed sector.
  W  - I'm at war with the owner of this sector.
  A  - An allied sector.
  P  - Oops! This sector has the PLAGUE.
  B  - The sector suffers from a production backlog or is a mine that cannot
       deliver its ore.
  ?  - This is a sector with a guessed designation. You will probably never
       see this flag. Most (all?) guessed sectors are water and they'll not
       show up in the info window anyway.

There are some flags for ships too:

  O  - The ship is dirty and will be auto ship'ed later on.
  S  - A sunken ship. Will be removed by the expunge menu option.


			     DELAYED COMMANDS

Delayed commands are in fact several queues of commands to be sent to
Empire. There may be up to 256 different queues, ranging from -128 to 127.

These numbers can be seen as priorities, just the same as task priorities on
the Amiga. 0 is the "normal priority". 127 is the highest possible priority
but it's recommended to use priorities from -20 to 20.

  The purpose of delayed commands are:

  - Allow ARexx to issue commands to Empire without interfering with the
    user.

  - Allow other command sources to enter commands without interfering with
    the user.

  - Updating the database in the background while the user is playing with
    something else.

  - Enter commands off-line that will be sent to Empire when we are
    connected to Empire. This is NOT implemented yet.
    Of course, you can write an ARexx macro for this if you like.


You may send delayed commands with the ARexx command queue_command() and
do_command().
If you don't want to see the delayed commands, set the init-variable
"HideDelayedCommands" to 1 in your init file. This can also be done
from the menu.

Delayed commands are executed whenever the user is idle at the prompt for
a given time. You may set this time in the init file too.

Empfe will execute the delayed command with the highest priority first. If
there is more than one, the oldest will be executed first. When you quit
Empfe, all delayed commands will be lost.




			 EMPFE IN NUMBERS

This section is for those of you who want to know how large Empfe really is
and what kind of equipment I use.

Empfe is around 26000 lines in C and a few lines in assembler, compiled
with Lattice C 5.05. I use PowerWindows to generate the windows,
requesters and gadgets. I always keep my Amiga version 1.1 manual handy
as well as autodocs for version 1.3.

I have been using DME 1.35 to write the program, but I'm using GnuEmacs
now.

Empfe was originally written on my old Amiga 500, but is now hacked
on my A2000 with lots of memory. Unfortunately only a 68000 machine,
but that's not the real problem. The real problem is that speed wasn't
the main goal when Lattice wrote their compiler.



		   EMPIRE VERSIONS AND PITFALLS

There are several versions of Amiga Empire around, but I'll try to give a list
of the versions I'm more or less familiar with and their possible problems
with Empfe. This list is in no way complete, just some random notes...

Ver 1.0
Available on Fish disk #118, this version should work with Empfe, but I
have not tested it for a long time. Written by Chris Gray.

Ver 1.1(?)-1.3
I never owned any of these versions, but Chris removed the country numbers
from one of them, he didn't remember which when he told me about it.
Empfe version 1 will not run properly with a Empire game without country
numbers. You may use ARexx with Empfe 2 and manually set a country number
for each country. Written by Chris Gray.

Ver 1.3w (There are earlier versions with a 'w' added too.)
Empfe 1 works great with this version, but it has a nasty bug that lets
you unload people from a ship as civilians and/or military, no matter what
they are. This is a hacked version by David Wright.

Ver 1.33w
Bug fixed 1.3w, I've heard that Empfe 1.x won't work well with it.

Ver 2.0
The first multi-user version of Amiga Empire. Has a flag to turn on country
numbers, but also a bug; you must do a 'edit world' after you have changed
the flag to have the new flag value recorded.
Great program! Written by Chris Gray.

Ver 2.1w
Available on Fish #329, this version is based on version 2.0.
Always displays the country numbers so you don't have to worry about that.
This version will NOT automatically flush cached data to disk when you log
out. If the Empire machine is rebooted without a manual flush or a proper
server shutdown, someone will loose badly. The reason for this behavior was
that when a user logs out of a multi-user game, a long delay occurs when the
sectors are flushed. This can be a great pain if you use a floppy disk.
Personally, I think the danger of loosing the changes long after you have
logged out is worse.
Updated by David Wright.

Ver 2.1
This version was the result of fixing all problems that came up with 2.0.
I think it still has the flag bug left as well as some other bugs.
By Chris Gray.

Ver 2.2w
An updated version of 2.1w, which corrects the buffer problem, and other
reported bugs. Includes new data verification features, and new messages
specifically for Empfe. Should work good with Empfe.
Updated by David Wright.

To summarize, get version 2.1 or later (without a 'w') if you want the
original. Get version 2.2w or later if you want David Wright's taste of
Empire. Really, there shouldn't be any big differences between them,
and they'll more or less tend to be merged in the future.

Empfe 2.0 should work with all these versions and I'll try to keep up with
future versions too. I will probably not support features added by people
other than Chris Gray and David Wright in the future.


Good Luck!

