(complete 0)
(set default_lang 4)

(set #bad-kick
(cat "You must be using Kickstart 3.0 to install this game"
))

(set #which-disk
(cat "In which partition should the game be installed?"
))

(set #which-disk-help
(cat "\nThis section lets you choose on which hard drive partition the "
     "Game files will be installed. "
     @askdir-help
))

;=============================================================================
; make sure we are running under V39

(if (< (/ (getversion) 65536) 39)
(
    (abort #bad-kick)
))

(user 0)
(welcome)
(set old_level @user-level)

;=============================================================================
; get target directory where game is to be installed

(set old_wb ("SYS:"))
(user 2)
(set target (askdir (prompt #which-disk)
			(help #which-disk-help)
			(default "")
			(disk)
			))
(user old_level)

;=============================================================================
; get the version from arp.library currently installed

	(if (= (exists "Libs:arp.library") 0)
		(
        (copyfiles (source "REKO01:")
	               (dest "LIBS:")
	               (pattern "arp.librar#?")
        )
		)
	)

(complete 5)

(copyfiles (source "REKO01:")
	       (dest "RAM:")
	       (pattern "lz")
)

(set workingMsg ("Extracting files from Main archive"))

(working workingMsg)

(run ("RAM:lz x REKO01:MAIN.LZH ram:"))

(complete 15)

(makedir (tackon target "REKO-Productions"))
(set wtarget target)

(copyfiles (source "RAM:REKO.infa")
	       (dest wtarget)
)

(rename (tackon wtarget "REKO.infa") (tackon wtarget "REKO-Productions.info"))

(set target (tackon target "REKO-Productions"))
(set @default-dest target)
(set wtarget target)

;=============================================================================
; get the version from medplayer.library currently installed

	(if (= (exists "Libs:medplayer.library") 1)
		(
		(protect "Libs:medplayer.library" "+rwed")
		)
	)
	(copylib
		(prompt	("Copying %s to %s" "RAM:medplayer.library" "Libs:"))
		(help	copyLibFileHelp
			"\n"
			"If you already have a copy of this library in the selected destination directory, the library "
			"included on the distribution disk will be compared to the one you "
			"already have. If your current library is an old version, the newer "
			"version will be installed.\n"
			"\n"
			@copylib-help
		)
		(source "RAM:medplayer.library")
		(dest "Libs:")
		(confirm)
	)

(complete 20)

;=============================================================================
; Put REKOCHARS in Fonts: directory

(copyfiles (source "RAM:")
	   (dest "FONTS:")
	   (pattern "REKOCH#?")
)

;=============================================================================
; Put REKO commands in C: directory

(copyfiles (source "RAM:REKO")
	   (dest "C:")
)

(copyfiles (source "RAM:ShowREKO")
	   (dest "C:")
)

(copyfiles (source "RAM:StripREKO")
	   (dest "C:")
)

;=============================================================================
; make some new drawers

(makedir (tackon wtarget "PICS"))
(makedir (tackon wtarget "MUSIC"))
(makedir (tackon wtarget "CARDS"))


(copyfiles (source "RAM:REKO.infa")
	   (dest wtarget)
)
(rename (tackon wtarget "REKO.infa") (tackon wtarget "MAKE-CARDS.info"))

(copyfiles (source "RAM:REKO.infa")
	   (dest wtarget)
)
(rename (tackon wtarget "REKO.infa") (tackon wtarget "CARDS.info"))

(copyfiles (source "RAM:")
	   (dest wtarget)
	   (pattern "MAKE#?")
)

(delete (tackon wtarget "MAKE-CARDS/PREF-Frames"))              
(delete (tackon wtarget "MAKE-CARDS/Example4"))                 
(delete (tackon wtarget "MAKE-CARDS/Example3"))                 
(delete (tackon wtarget "MAKE-CARDS/Example2"))                 
(delete (tackon wtarget "MAKE-CARDS/Example1"))                 

(copyfiles (source "RAM:KlondikeIII.info")
	   (dest wtarget)
)

(copyfiles (source "RAM:KlondikeIII")
	   (dest wtarget)
)

(if (= (exists (tackon wtarget "REKO.Prefs")) 1)
	(
	(rename (tackon wtarget "REKO.Prefs") (tackon wtarget "REKO.Prefs.OLD"))
	)
)

(if (= (exists (tackon wtarget "REKO.Prefs.info")) 1)
	(
	(rename (tackon wtarget "REKO.Prefs.info") (tackon wtarget "REKO.Prefs.OLD.info"))
	)
)

(copyfiles (source "RAM:StdPrefs.REKO")
	   (dest wtarget)
)

(copyfiles (source "RAM:REKO.Prefs.info")
	   (dest wtarget)
)

(copyfiles (source "RAM:REKO.Prefs")
	   (dest wtarget)
)

(copyfiles (source "RAM:ShowREKO.Docs.info")
	   (dest wtarget)
)

(copyfiles (source "RAM:ShowREKO.Docs")
	   (dest wtarget)
)

(copyfiles (source "RAM:REKO.Guide.info")
	   (dest wtarget)
)

(copyfiles (source "RAM:REKO.Guide")
	   (dest wtarget)
)

(complete 25)

(copyfiles (source "RAM:")
	   (dest wtarget)
	   (pattern "REKO.Docs#?")
)

(copyfiles (source "RAM:FullView")
	   (dest wtarget)
)

(copyfiles (source "RAM:")
	   (dest wtarget)
	   (pattern "REKO.QRCard#?")
)

(complete 30)

(set workingMsg ("Extracting files from Pics archive"))

(working workingMsg)

(delete (tackon wtarget "PICS/Intro.REKO"))                 
(delete (tackon wtarget "PICS/Default.WINP"))                 

(set destdir (tackon wtarget "PICS/"))

(run ("RAM:lz x REKO01:PICS.LZH \"%s\"" destdir))

(complete 45)

(set workingMsg ("Extracting files from Music archive"))

(working workingMsg)

(set destdir (tackon wtarget "MUSIC/"))

(run ("RAM:lz x REKO02:MUSIC.LZH \"%s\"" destdir))

(complete 65)

(set workingMsg ("Extracting files from Cards archive"))

(working workingMsg)

(delete (tackon wtarget "CARDS/Default.REKO"))                 
(delete (tackon wtarget "CARDS/Standard.REKO"))                 
(delete (tackon wtarget "CARDS/16C-C64.REKO"))                 
(delete (tackon wtarget "CARDS/Puzzled.REKO"))                 
(delete (tackon wtarget "CARDS/AirBrush.REKO"))                 

(set destdir (tackon wtarget "CARDS/"))

(run ("RAM:lz x REKO03:CARDS.LZH \"%s\"" destdir))

(complete 80)

(run ("RAM:lz x REKO04:CARDS.LZH \"%s\"" destdir))

(complete 95)

(delete	"RAM:lz")
(delete "ram:Rekochars.FONT")
(delete "ram:REKO.QRcard.info")        
(delete "ram:REKO.QRcard")              
(delete "ram:REKO.Prefs.info")          
(delete "ram:REKO.Prefs")               
(delete "ram:REKO.infa")                
(delete "ram:REKO.Docs.info")           
(delete "ram:REKO.Docs")                
(delete "ram:ShowREKO.Docs.info")           
(delete "ram:ShowREKO.Docs")                
(delete "ram:REKO.Guide.info")           
(delete "ram:REKO.Guide")                
(delete "ram:Reko")                     
(delete "ram:ShowREKO")                     
(delete "ram:StripREKO")                     
(delete "ram:medplayer.library")        
(delete "ram:KlondikeIII.info")          
(delete "ram:KlondikeIII")               
(delete "ram:FullView")                 
(delete "ram:StdPrefs.REKO")                 

(delete "ram:MAKE-CARDS/Various-Frames&Symbols")   
(delete "ram:MAKE-CARDS/REKO-cutter2")             
(delete "ram:MAKE-CARDS/REKO-cutter1")             

(delete "ram:MAKE-CARDS/RED/SYMBOLS")                  
(delete "ram:MAKE-CARDS/RED/FRAME")                    
(delete "ram:MAKE-CARDS/RED/CARD01")                   
(delete "ram:MAKE-CARDS/RED/CARD00")                   

(delete "ram:MAKE-CARDS/GREEN/SYMBOLS")                  
(delete "ram:MAKE-CARDS/GREEN/FRAME")                    
(delete "ram:MAKE-CARDS/GREEN/CARD01")                   
(delete "ram:MAKE-CARDS/GREEN/CARD00")                   

(delete "ram:MAKE-CARDS/BLUE/SYMBOLS")                  
(delete "ram:MAKE-CARDS/BLUE/FRAME")                    
(delete "ram:MAKE-CARDS/BLUE/CARD01")                   
(delete "ram:MAKE-CARDS/BLUE/CARD00")                   
 
(delete "ram:REKOCHARS/22")
(complete 100)