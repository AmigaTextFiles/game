

       D E F E K T R I S   9 4   D O C U M E N T A T I O N
       ===================================================

 CONTENTS (by line number)
 --------

1 - Contacting the author (plus a little introduction).......36

  1.1 - Getting the Source Code..............................67

2 - Installing and Running Defektris.........................77

3 - The Main Control Screen..................................130

4 - Playing the Game.........................................155

  4.1 - Aim and Controls.................159

  4.2 - Bonuses and Scoring..............246

5 - Viewing and saving high scores...........................304

6 - Creating Custom Levels...................................325

  6.1 - The Main Editor Screen...........341

  6.2 - The Edit Level Screen............412






 1 - CONTACTING THE AUTHOR
 -------------------------

Defektris was programmed in assembler by Sam Baker, with music by Keith
Baker and graphics by Sam Baker and Mike Duggan. It began in June 1993
when my Noughts and Crosses game failed and I decided to write something
with less artificial intelligence in it - another falling blocks game.
As the game progressed though it turned into more than just another version
of a certain Russian puzzle game - it became a Russian puzzle game with
bonuses and a level editor!

Anyway, please contact me if you find any bugs or want to employ me as a
programmer! I'm just a poor Computer Science student y'see.

Please send any mail to:

 SamSoft,
 100 Beauley Rd.,
 Southville,
 Bristol,
 BS3 1QG.

or e-mail me at university:

 csysb@scs.leeds.ac.uk

E-mail replies guaranteed, snail-mail not!

Defektris 94 is dedicated to my cats.


   1.1 - Getting the Source Code
   -----------------------------


The source code for Defektris 94 is available from SamSoft and includes the raw graphics files and samples. It comes on
two disks which are included in the price of £10 (pound sterling). Just send me £10 in a form that I can easily get
deposited into my bank account along with your address. In return I will send the source code in a jiffy bag.



 2 - INSTALLING AND RUNNING DEFEKTRIS
 ------------------------------------

Defektris must be distributed with the following files:

  Defektris                       (The program itself)
  Defektris.info                  (The program icon)
  DefektrisEditor.data            (The level editor graphics)
and
  Defektris.doc                   (This documentation file)

Other optional files include:

  DefektrisHiScores               (The highscore table)

and also any files ending in the .dlv suffix meaning level data saved
by the Defektris level editor.

The DefektrisEditor.data file must be in the Defektris: volume. This can
be done by putting the file in the root directory of a disk or volume called
Defektris or by adding the following line to your startup-sequence:

  assign Defektris: <dirname>

where <dirname> is the name of the directory where the data file is located.
This is also the directory where high scores will be saved.

To load and save Defektris level editor files the libs: directory must
contain either asl.library (Kickstart 2 and above), or reqtools.library
for any Amiga.

Reqtools.library is copyright Nico François, used with his kind permission.

Defektris can be run from an AmigaDos Shell or CLI or from Workbench by
double-clicking on its icon. When run Defektris will attempt to load the
DefektrisEditor.data and DefektrisHiScores files from the Defektris:
directory.

When Defektris is loaded a file requester will appear. This can be used to
load a Defektris custom level file (see below) ending in the suffix, .dlv.
To carry on select a file and click on load/OK or just click on play without
loading any levels.

NOTE: If Defektris cannot find the DefektrisEditor.data file or if there is
not enough memory available to load it and allocate other level editor
memory then Defektris will still run but the file requesters will not appear
and the Edit Levels and Custom buttons on the Defektris Control Screen will
not operate (shown by a criss-cross pattern on the buttons).





 3 - THE MAIN CONTROL SCREEN
 ---------------------------

As soon as Defektris is loaded the intro will appear with some text for
you to read if you're bored. The right mouse button can be used to move on
to the next screen of text, otherwise it will change after a timeout.

Pressing the left mouse button, fire or any key will end the intro taking
you to the Defektris control screen. From here you can play three different
game types, edit levels and view the high scores. All the options are
represented by pretty buttons you can click on! Throughout such screens
the joystick and mouse can be used to move the pointer and select options.
The mouse is usually easiest, especially in the level editor. The keys
are used in some parts for various things - in the control screen every
button has a keyboard shortcut (underlined), that has the same effect as
clicking on it.

The title sequence can be viewed by clicking on its button. There are also
instructions available by clicking on the (surprise surprise) Instructions
button. The other options are documented in later sections.





 4 - PLAYING THE GAME
 --------------------


   4.1 - Aim and Controls
   ----------------------


To begin a game click on the play button from the Control Screen. This will
begin one of three types of game (selected on the Control Screen). In all
of the games the aim is to navigate the falling blocks into positions that
make full horizontal lines of blocks at the bottom of the screen. When this
happens that line will disappear and another block will fall. The game ends
when there is no room for any more blocks to fall or the Escape key is
pressed.

In some levels there is a distinct pattern in the background over which the
blocks will fall. If the blocks cover this pattern a bonus is awarded and
a nice noise hurtles out of your speakers! The points you are given depend
on how efficiently you cover the pattern. i.e. if the pattern is made up
of six squares and you cover it with exactly six squares of block then you
get the maximum number of points. NOTE: To make some of the levels more
challenging covering the bonus at the same time as filling a horizontal line
does not give you the points. Also the bonus can only be scored once on each
level.

Some of the blocks that fall have special properties. These properties are
ONLY activated when the special block is used to make a line. If a block
falls with a bomb next to it then completing a line with that block will
trigger a series of explosions filling (if there are any) holes in the
pile of blocks already on the screen. A block may also have a letter next
to it from the word BONUS. If so, making a line will add that letter to
the Bonus display to the right of the screen. When all letters are lit
a little face will tell you and points (3349 of them) will be added to your
score.

It is possible to fill a maximum of four horizontal lines without using the
bomb. Manage the maximum four (or more with the bomb) and you will be
congratulated for your 'TOP MOVE'. The score you get rises exponentially
with the number of lines you get at once - in other words getting four lines
at once scores more than getting four lines seperately. See the Scoring
section below for details.

The three game types available are:

    i) Levels

 This is the default selection. In this mode clicking on Play lets you
 play 80 default levels. In this mode the Lines counter display on the left
 of the screen shows how many more lines must be completed to progress to
 the next level. Each level may or may not have a bonus pattern to cover.
 If it does there will be holes in the blocks so the pattern can be seen
 through them.

    ii) Custom

 This game type is the same as Levels above except that the 80 default
 levels are replaced by either the levels that were loaded on startup, or
 if none were loaded, a single default level.

    iii) Arcade

 In this mode there is only one level and instead of a series of
 increasingly difficult levels, the single level gets faster the more lines
 you complete. In this case the Lines counter display shows how many lines
 have been completed during the current game.


The blocks can be controlled using the joystick or keys as shown below:

 JOYSTICK:

    Left                            - Move block left.
    Right                           - Move block right.
    Down                            - Drop block quickly.
    Fire                            - Rotate block by 90 degrees.

 KEYS:

    Left Arrow Z or X               - Move block left.
    Right Arrow . or /              - Move block right.
    Down Arrow or Space             - Drop block quickly.
    Up Arrow Shift Alt or Amiga     - Rotate block by 90 degrees.

Other functional keys are:

    P                               - Pause.
    M                               - Toggle Music/FX
    ESCAPE                          - Quit.


   4.2 - Bonuses and Scoring
   -------------------------


When creating lines the most points are scored by:

   a) making more lines at once
   b) making the lines higher up the screen
   c) dropping the blocks faster

When covering the bonus pattern the most points are scored by covering
all the bonus squares but as few of the other squares as possible.

 SCORING FORMULAE:

The score for completing lines is calculated as follows:

 The BASIC score for each line made in one move is

         LINENUMBER * 26 + 163

 where LINENUMBER goes from one to the number of lines got together as
 each is evaluated. The following table shows the resultant scores:

	Lines	Line Score	Total Move Score

    1:      163         163
    2:      189         352
    3:      215         567
    4:      241         808
    5:      267         1075
    6:      293         1368
    7:      319         1687
    8:      345         2032
    etc...

 The score is THEN multiplied by 20 and then divided by SPEEDDIV where:

         SPEEDDIV = (Number of slow moves)*2 + (Number of fast moves)

 and the moves referred to are the 8 line falling movements.



The score for covering the bonus is calculated as:

         BONUS = 2*(Nth triangle number)

where N is the number of UNcovered squares.



The score for getting all the bonus letters is fixed at 3349.





 5 - VIEWING AND SAVING HIGH SCORES
 ----------------------------------

When you get a high score you get to enter your name. In the enter-your-
name screen type your name with the keys or click on the buttons using the
pointer. Clicking on the CLEAR button or pressing escape will clear the
name and clicking on DONE or pressing return will exit.

The High Scores can be viewed by clicking the obvious button from the
Defektris Control Screen. The scores are loaded automatically if a file
called DefektrisHiScores is found in the Defektris: directory. The
Quit Options set of buttons on the Control Screen determines what happens
to the high scores WHEN QUIT IS SELECTED - no file output occurs until the
program exits. Abandon will leave the DefektrisHiScores file unmodified,
Save will replace it with the current high scores, and Delete will remove
the file if it exists.





 6 - CREATING CUSTOM LEVELS
 --------------------------

Here comes the fun part - designing new levels to be used in Defektris!
Level data is stored in files ending with .dlv that can store 15 levels.
The levels are loaded via an ASL or reqtools file requester that appears
on startup and edited from within Defektris. Modifications can be saved
on exit via another file requester. NOTE: Changes can only be saved to
disk when Defektris exits. Clicking save in the editor only saves the
changes in memory. To save to disk you must also select Quit and then
save the levels with the file requester.

The levels you create or load can be played by selecting the Custom Game
Type from the Defektris Control Screen and then clicking on play.


   6.1 - The Main Editor Screen
   ----------------------------


The level editor is entered by clicking on Edit Levels from the Defektris
Control Screen.

NOTE: It is much easier to use the mouse as a control method rather than the
joystick when editing levels.

The screen displayed first shows all the 15 levels as a grid of icons
(pictorial representations). Each icon has a level number and a 32 by 16
pattern. This is the background pattern used in the level enlarged, to
remind the user which levels correspond to each icon.

Each icon can be selected by clicking on it with the mouse or joystick
pointer, but only one can be selected at one time. The arrow keys can also
be used to select different levels. From here the levels can be edited
individually, sorted into order and deleted.

At the bottom of the screen is a panel of options. These are described from
left to right and all but APPEND operate on the currently selected level
(shown by a red box round the level number) :

    a) EDIT - This takes you into the Edit Level Screen, allowing you to
       modify the current selected level - see Section 6.2 below. If the
       selected icon is an Empty Level this option will not work - use
       DEFAULT or INSERT to fill the space with a default level to edit.

    b) INSERT - This inserts a Default level at the current position if
       there is an empty level anywhere after the currently selected one.
       This may shift levels forward to create a space in the current
       position.

    c) DEFAULT - This replaces the currently selected level with a default
       level - WARNING: This operation will delete the current level from
       memory forever!

    d) APPEND - This option finds the first empty level (if there is one),
       replaces it with a default level and selects it ready for editing.
       This is usually the most convenient way to add a new level.

    e) SWAP - This option is used to swap one level with another. To swap
       a pair of levels around select one of them, click on SWAP then click
       on the level you want to swap it with. Clicking on SWAP changes the
       mouse pointer to a SWAP pointer until the mouse (or fire) is clicked
       again.

    f) COPY - This operation will copy a level over another one. To copy an
       icon select it and then click on copy. The mouse pointer then changes
       to a COPY pointer and the next icon you click on will be replaced by
       the currently selected icon - WARNING: This operation will delete
       the level you copy over from memory forever!

    g) DELETE - Clicking on DELETE will delete the currently selected level
       from the list. THIS DATA CAN NOT BE RETRIEVED!

    h) SAVE & EXIT - This will return you to the Defektris Control Screen
       saving all modifications BUT ONLY TO MEMORY. To save to disk Quit
       must be selected and the file requester used to save the data.

    i) ABANDON & EXIT - This also returns you to the Defektris Control
       Screen but changes made to the levels will not be remembered. This
       means all changes (in the current edit only) will be lost forever.

With these options the levels can be sorted into order changed in any way
without altering the previous edit unless SAVE & EXIT is selected. If SAVE
& EXIT IS selected then the changes are kept in memory and can be saved to
disk when Quit is selected and the file requester appears.


   6.2 - The Edit Level Screen
   ---------------------------


Clicking on EDIT from the Main Editor Screen will take you to the Edit Level
Screen. Here the currently selected level is displayed as it appears in the
game. but with a control panel added at the bottom of the screen. This is
used to make modifications to the level.

The attributes of a level that can be changed are listed below with
details of how to change them:

 o Number of lines required to complete the level.

   This is changed by editing the three digit number to the left of the
   panel with LINES: written above it. This affects the difficulty of the
   level.

 o Speed of falling blocks.

   This is changed by editing the two digit number to the left of the panel
   with SPEED: written above it. The speed can vary between 1 (slow) and
   35 (fast).

 o The Background Pattern.

   The 32 by 16 pixel pattern displayed in the background is enlarged in a
   box in the control panel. Here it can be edited using the pointer and
   fire or the left mouse button. Clicking on a square in the grid CHANGES
   the colour and all drawing done without releasing the button uses this
   initial colour, opposite to the colour clicked on initially. This allows
   deleting and drawing to be done with the same controls. While the pointer
   is WITHIN the pattern grid, pressing escape will clear the pattern. This
   saves deleting it manually. Changes can be seen in the main game screen
   immediately as they would look in the game.

 o The Bonus Pattern.

   The background bonus pattern gives the player points when covered. To
   enable a bonus pattern in the current level make sure the Shape Bonus
   button is marked ON. ON/OFF can be toggled by clicking the button. To
   enable editing of the bonus pattern the EDIT button must be toggled so
   that the text beside it reads BONUS. In this mode when the mouse pointer
   moves onto the game screen it turns into a bonus pattern square. It can
   then be used to draw a bonus pattern onto the box where the shapes fall.
   To view all of the box click on the down arrow near the middle of the
   panel until the game screen scrolls the box into view. When EDIT BONUS
   is selected and the pointer is over the box in the game screen, pressing
   escape will clear the Bonus pattern.

 o The Block Pattern.

   A pattern of blocks can be drawn that will appear at the start of the
   level. This generally makes the level harder with less space for
   wiggling the blocks around. To edit this pattern click on EDIT until
   EDIT PATTERN is displayed. Then moving the pointer off the panel turns
   it into a block that can be drawn onto the box in the game screen.
   Again patterns drawn here can be deleted by pressing escape while the
   pointer is over the box.

 o The Colour Palette.

   Under the Control group of buttons on the right of the panel is an
   Edit Palette button. Clicking on this replaces the panel with a colour
   editing panel described below. Clicking on DONE in the Palette Editor
   returns you to the main editor panel.

Other buttons are:

 RESTORE - this restores the edited level to its state before any editing
 took place losing the current changes permanently.

 VIEW ALL - this button removes the editpanel from view so the whole screen
 can be seen. Pressing a key, fire or the left mouse button brings the panel
 back.

 DONE - this returns you to the Main Editor Screen saving the current
 changes IN MEMORY.

Once you return to the Main Editor Screen the changes you just made can
only be restored by clicking on ABANDON & EXIT in the Main Editor Screen,
but this also restores all levels changed during the current edit - so
make sure you want to keep the changes before clicking done in the Edit
Level Screen. One good way of testing modifications is to copy the level
into an empty space if available and then change one of the copies.

 The Palette Editor:

In the Palette Editor there are 16 colours that can be edited using a set
of three sliders. There is a horizontal slider for Red, one for Green and
one for Blue. Using these each colour is selected from a palette of 4096.
The sliders can be moved by clicking on a position from 0 to 15 across their
length or by clicking on them, holding the mouse/fire button down and
dragging the slider around to the desired value. The onscreen colour will
change as the slider is moved around. The values (0 to 15) of the Red(R),
Green(G) and Blue(B) sliders are shown to the right of the panel as they
change.

The sliders always act on one colour at a time. This colour is highlighted
in the colour panel below the sliders. To select a different colour either
click on the colour in the panel or click on it anywhere in the game screen
area. A description of the currently selected colour is displayed at the
bottom of the panel.

Different areas of the screen can be viewed by clicking on the up and down
arrow buttons - these scroll the game screen up and down.

All changes made to the palette in the current use of the Palette Editor
can be restored by clicking on the RESTORE button.

When the palette edit is finished pressing DONE returns to the Edit Level
Control Panel.

