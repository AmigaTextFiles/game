
                __/\____ù /\__  _____  _______  ______ùû__ù
                \ /`~\` |/ `~/\ \`~~~\ \`~~~~~\/`~~\`~||`~|
                // ___ç |   †  \ \_   \ ë| |  // .  \ ||| |
               a\__  \     (|   ë__)   )||.  (   |   )†ü  |
               X/'   ú  |'  ü   |'    / |  õ  \     /     |
               å____/é__è\___ç__Ä____/  é__è\  ñ___å__/\__é
               ooOoooO PrEsEnTs              \/    oOoooOoo

                              TAPE WORM-FS
                              USER'S GUIDE

INTRODUCTION

Congratulations on your purchase of TapeWorm-FS for your Amiga computer!
TapeWorm-FS is fully-functional filesystem for SCSI tape drives.  By
using TapeWorm-FS you may access your tape drive just as you would any
other AmigaDOS volume.  That means that you can get directories, add and
delete files, copy files, and perform all file management operations
as if you were using a floppy or hard disk drive.  Note: Since through
TapeWorm-FS your tape drive functions as a Write Once Read Many (WORM)
drive, all data copied to the drive remains on the tape even if you
delete files.  See the section on Using TapeWorm-FS for more information.

System Requirements

TapeWorm-FS will work on any Amiga computer (or Video Toaster Workstation)
operating under Workbench 2.x or above with a SCSI tape drive (DAT,
8mm, or QIC format).  There are no minimum memory requirements.  Drives
that support the SCSI II fast search mode are recommended for superior
performance.

Installation

The TapeWorm-FS disk is not copy protected in any way so you may
make one archival copy in order to protect your investment.  To install
Tape-Worm-FS onto your hard drive, follow these steps:

Step 1: Immediately make a backup copy of your TapeWorm-FS original disk, 
        and store it in a safe place.
Step 2: Insert the copy of the TapeWorm-FS disk into a floppy drive, and 
        open the disk by double-clicking on its icon from Workbench.
Step 3: Once the disk contents are displayed on your screen, you will see
        an icon named "Install TapeWorm-FS".  This is the installation
        program that will place the TapeWorm-FS files into the proper
        locations.  Double click on this icon to execute the installation
        program.
Step 4: The TapeWorm-FS Installation Program window will appear on your
        screen.  You must Set Installation Mode by selecting the 
        Intermediate User or Expert User gadget.  The Expert User mode
        will allow you to control the installation process at every step,
        letting you decide exactly where you wish each file to be 
        installed.  Click on the Proceed With Install gadget to continue
        or the Abort Install gadget to end the process.

TapeWorm-FS is now installed on your system.  You must now set your 
system-configuration.  See the section on Configuring TapeWorm-FS.

If you do not wish to use the installation program to install TapeWorm-FS,
you may perform a manual installation by following these steps:

Step 1a: If your system is operation under AmigaDOS 2.1 or later, copy the
         file 'Tape' from the TapeWorm-FS disk to your system's 
         'Devs:DosDrivers' directory.
Step 1b: If your system is operating under AmigaDOS 2.0, append the
         contents of 'TW.Mountlist' file to your system's 'Devs:MountList'
         file and add the command 'Mount TAPE:' to your system's 
         'S:User-Startup' file.
Step 2:  Copy the file 'TapeWorm-FS' to your system's 'L:' directory.

If a previous version of TapeWorm-FS is already installed on your system,
and you wish to update the version you are using, perform these steps:

Step 1: Copy the file 'TapeWorm-FS' from the disk to your system's 'L:'
        directory.
Step 2: Copy the TWConfig and TWCtrl files to the directory of your 
        choice.
 
TapeWorm-FS is now installed on your system.  Now you must configure your
drive for operation on your system and set the TapeWorm-FS options.

The TapeWorm-FS Utilities
-------------------------

TW Config

Before you can use TapeWorm-FS, you must properly configure the TW.config
file to reflect your system configuration.  You may do so by using the
TWConfig utility which was placed in the location on your hard drive
that you specified during the installation procedure.

Start the TWConfig program from Workbench or CLI, and the TWConfig screen
will appear.  From this screen you will be able to:

   Configure Drive
   Set Options
   Format
   Recover

Configure Drive

Click on the Configure Drive gadget to configure your drive for use
under TapeWorm-FS.

Device

Under the Device requester, you will be able to select the device driver
for your SCSI controller.  (For example, if your computer is the Amiga
3000, you would select "scsi.device" for Commodore's SCSI controller.)

Unit

You must select the Unit number for the SCSI tape device you wish to
use under TapeWorm-FS.

Blocksize

Specify the block size for your tape drive by clicking on this cycle
gadget.  It is recommended that you leave the blocksize at 512 bytes
for all drives except Exabyte 8mm drives, which should have a blocksize
of 1024 bytes.

TapeSize

Enter the approximate size of the tape being used in this gadget (this
allows the TapeWorm-FS to calculate percentage of tape full when
displaying information about the tape device).

When you have configured the drive, click on Save gadget.  Click on the
Cancel gadget of you do not wish to save the current configuration.

Note that most of these options only take effect when TapeWorm-FS is
started.  You must reboot or kill (see the TWControl section) and restart
the filesystem for the changes to take effect.

Set Options

There are several options you may select for the operation of TapeWorm-FS.
Click on the Set Options gadget on the TWConfig main screen.

Buffer Reads

Files are copied to your Buffer Path (see the next page for an explanation
of the Buffer Path) when they are opened.  The system then reads from 
the files that are in your Buffer Path.  This feature is only really
useful if the program you are using repeatedly seeks throughout the file.
For example, most 'LHARC' programs seek back and forth when extracting
files.

Buffer Writes

Files are written to your Buffer Path and copied to tape when the file
is closed.  This is necessary for programs that seek around in a file
as they are writing.  Most programs that write IFF files seek back to the
beginning of the file after they are done writing, so this option is very
useful.  Also, this option allows multiple files to be written to the
tape simultaneously, which is not normally possible, due to the inherent
limitations of tape drives.

Keep Directory on Tape

If your tape drive supports partitioning, selecting this option will let
TapeWorm-FS keep the directory of the tape on the tape itself.  The
directory will be kept in your directory path only when the tape is in
the drive.  When you have selected this option, you must use the TWControl
program to eject the tape, since TapeWorm-FS needs to update the directory
on the tape to reflect the temporary directory that is on the hard disk.
TapeWorm-FS will lock the tape in the drive (on drives that support this
feature) so that the tape may not be ejected manually.  If your system
crashes or otherwise fails before the temporary directory is written
to the tape, the temporary directory will be updated the next time you
insert the tape.  Unlike the other available options, this option takes
effect when you format a tape and remains in effect for that tape.

Existing Files Are Read Only

This is the normal mode of operation for TapeWorm-FS.  Files can be read
or overwritten, but they cannot be opened and subsequently written to.
If both the Buffer Reads and Buffer Writes are enabled, you can turn
off this option so that files may be updated in place.

Keep '.info' Files With Directory

By default, '.info' files are kept on tape just as other files.
However, this results in slow Workbench performance as it must seek
around the tape to load files.  Selecting this option directs 
TapeWorm-FS to keep '.info' files as part of the directory file.

Directory Path

This is where you specify the location in which you wish TapeWorm-FS
to store the device directories.  The default path is your system's
'S:' directory.

Buffer Path

If you have selected Buffer Reads or Buffer Writes, this is the location
in which TapeWorm-FS will maintain the buffer.  The default path is in
your system's RAM device.  The buffer is used to store files for reading
and writing (when Buffer Reads or Buffer Writes is selected) so that
these operations will be performed more quickly than if the reads and
writes were from the tape directly.

When you have set the options you desire, click on the Save gadget.
Click on the Cancel gadget if you do not wish to save the current
configuration.

Format

Before accessing your tape drive through TapeWorm-FS, you must insert
a tape into your drive and format the tape.  Insert the tape you wish
to format into the tape drive.  To format the tape, click on the Format
gadget on the TWConfig main screen.  A requester will appear that asks
you to Enter volume name you wish to give to the tape.  Type the name
into this requester and click on the Continue gadget.  TapeWorm-FS will
now format your tape.  If you wish to exit without formatting a tape,
click on the Abort gadget.

WARNING: You must only format the tape before using it for the first
time.  If you format the tape again, any data that may have been
previously written to the tape will be lost.

Recover

Should your tape directory become unavailable to you.  TapeWorm-FS
allows you to rebuild a directory file from the information on a tape.
Insert the tape for which you wish to have a directory rebuilt, then
click on this gadget on the TWConfig main screen.

TWCtrol

The TWCtrl utility has the following four options (they can also be
invoked from the CLI using the template "TWCtrl <command>):

   Inhibit
   Un-Inhibit
   Kill
   Eject

Inhibit

Selecting this option prevents the filesystem from accessing the tape
drive.  This allows you to make use of other programs that access the
tape drive, such as backup utilities (i.e., Ami-Back).

Un-Inhibit

Selecting this option allows the filesystem to access the tape drive
after it has been inhibited.

Kill

This option causes the filesystem to exit.  This is useful if you want
the filesystem to be restarted in order to load a new configuration
or if you are done using the current configuration.  This will only
take affect if there are no outstanding locks on the filesystem
(e.g., there are no assigns to the filesystem, you aren't CD'd to it,
and there is no volume in the drive).

Eject

The option causes the tape in the drive to be ejected (on drives that
support eject).  If the tape was formatted with the "Keep Directory
on Tape" option, the directory on the tape will be updated.

Using TapeWorm-FS

TapeWorm-FS allows you to access files on your tape device in the same
way as you would any other AmigaDOS device.  The commands such as
dir, copy, list, delete, etc. work transparently on a device accessed 
through TapeWorm-FS.  However, since data cannot actually be deleted
from within a tape (data can only be appended to a tape without writing
over the existing data), TapeWorm-FS causes your tape device to 
function as a Write Once Read Many (WORM) drive.  This means that every
file ever written to the device remains on the device, even if you delete
the file.

When you use the delete command on a file that is located on a TapeWorm-
FS device, the directory file that is maintained for the device is
updated so that the filename will no longer appear by using the
standard AmigaDOS and Workbench commands.  However, you can still access
overwritten or deleted files from the CLI by using the special 
character "@" with a directory or filename.

Type "file@<number>" to obtain the version <number> of file.  Versions
start at 1 and go up.  The latest version of a file does not have a 
version number.

Type "dir@" in order to have deleted or overwritten files show up in
the directory listing using the "file@<number>" notation.

Type "dir@<date>" in order to display only files less than or equal
to <date> in the directory listing.  This also uses the 
"file@<number>" notation.

Theory of Operation

TapeWorm-FS is an AmigaDOS filesystem handler.  A handler acts as an
interface which allows AmigaDOS to access a piece of hardware.  For
example, 'SER:' allows access to the Amiga's serial port.  A filesystem
handler not only allows access to a storage device, but it maintains
information on the device about files and directories as well.

Unlike a hard drive, a streaming tape drive does not allow any arbitrary
block on the tape to be read or written.  Data can only be written by
being appended to the end of the tape.  Also, the tape must be positioned
to read an arbitrary block.  Positioning the tape requires much more
than the corresponding hard disk operation.

Due to these limitations, TapeWorm-FS does not keep directory and file
information on the tape itself as FastFileSystem or other hard disk
filesystems would.  TapeWorm-FS maintains the directory information
in a file on your hard disk, and it uses the tape only for storing
the actual file data (as well as recovery information).

Performance

Once your directory files become large you will notice a slow-down
when performing directory operations.  This is due to the way AmigaDOS
performs seeks within large files.  We recommend adding buffers (using
the AmigaDOS command AddBuffers) to the drive on which your "Directory
Path" is located.  As a rule of thumb, add one buffer for every 36k in
size of the largest directory file.

The Buffer Reads and Buffer Writes options can greatly increase 
performance for programs that seek around in a file, or perform lots
of little reads and writes.  A RAM directory is the best place to set
your Buffer Path except when you have files that are larger than the
amount of free RAM available on your system.

Note: The most efficient way to use a tape drive is to read files off
in the same order they were put on.  This eliminates seek time, since
after reading a file the tape is immediately positioned to read the
next file.

Appendix I:

TW.Config File Format

DEVICE = <scsi device name>
UNIT = <scsi unit number>
BLOCKSIZE = <block size in bytes>
TAPESIZE = <size of tape in blocks (=MB*2048 for 512 byte blocks)>
DIRPATH = <path to keep directory files (with trailing '/')>
FASTLOCATE = <TRUE or FALSE, to (use/not use) SCSI2 fast locate command>
DEBUG = <optional debug file name and path>
BUFFPATH = <path to keep temporary files (with trailing '/')>
BUFFERREADS = <TRUE or FALSE, Copy file to BuffPath on open>
BUFFERWRITES = <TRUE or FALSE, Write file to BuffPath, copy on close>
DRIVE = <the manufacture and model of the drive this setup is for>
SUPP_PARTITION = <TRUE or FALSE, Does this drive support partitioning?>
MAXBLOCKSIZE = <Maximum blocksize of this drive>
PARTITION = <TRUE or FALSE, Keep directories on tape>
READONLY = <TRUE or FALSE, Existing files are read only>
INFOWITHDIR = <TRUE or FALSE, ".info" files are kept in directory>
USE24BITDMA =<TRUE or FALSE, Use 24 bit DMA-able memory for buffers>

The following is an example TW.Config file:

DEVICE = scsi.device
UNIT = 4
BLOCKSIZE = 512
TAPESIZE = 1300
DIRPATH = SYS:S/
FASTLOCATE = TRUE
DEBUG = SYS:debug/
BUFFPATH = RAM:
BUFFERREADS = TRUE
BUFFERWRITES = TRUE
DRIVE = ARCHIVE Python
SUPP_PARTITION = TRUE
MAXBLOCKSIZE = 16777215
PARTITION = TRUE
READONLY = FALSE
INFOWITHDIR = TRUE
USE24BITDMA = FALSE

Appendix II:

Compatible Tape Drives

The following is a partial list of the drives which are compatible
with TapeWorm-FS.

Archive Python DAT drive
Archive Sidewinder 250
Archive Viper 2525s
Commodore 3070
Exabyte 8mm
Hewlet Packard DAT drive
Sony DAT drive
Tandberg 3640
Teac MT-2ST
Wangtek 5125
Wangtek 5150es
Wangtek 5525es
Wangtek 6200 DAT
Wangtek SCSI-36
Xybyte 8mm (2.3 gigabytes)

If you are able to use TapeWorm-FS successfully with a tape drive not
listed about, please contact us so that we may include the drive name
in the next manual revision.

SKID ROW  SKID ROW  SKID ROW  SKID ROW  SKID ROW  SKID ROW  SKID ROW



