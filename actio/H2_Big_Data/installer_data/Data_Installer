(set #dest-prompt 
	(cat
		"Select the directory where you have Heretic II installed."
    	)
)

(procedure P_DoInstallConfig
(
  (set #Mod1 "Install Config")
  (set #Mod2 "Do not install Config")
  (set #install-Mods "Install config.cfg with Server IPs ? If you do this, this will overwrite your Heretic II Video Mode and Control Configs")
	(
		(set Addons
			(askoptions (choices #Mod1 #Mod2)
        			(prompt #install-Mods)
      				(help   #install-Mods)
      				(default 0)
 			)
 		)

	(if (IN Addons 0)
	(
   (copyfiles
 (prompt "Installing config.cfg")
 (help @copyfiles-help)
 (source "Data/user/config.cfg")
 (dest (tackon #dest-dir "user"))
    )
	)
  )
)
)
)

(procedure P_DoRunFixScript
(
  (set #runscript "Run Multiplayer Fix Script")
  (set #donotrunscript "Do not run script")
  (set #install-runscript "Do you want to run the fix script ? You should do this if you had installed earlier versions of this archive before. If not you should select No.")
	(
		(set Addons
			(askoptions (choices #runscript #donotrunscript)
        			(prompt #install-runscript)
      				(help   #install-runscript)
      				(default 0)
 			)
 		)

	(if (IN Addons 0)
	(
		(delete (tackon #dest-dir "base/players/male/gandhig.m8"))
    (delete (tackon #dest-dir "base/players/male/gandhigdmg.m8"))
		(delete (tackon #dest-dir "base/players/male/gandhig_i.m8"))
		(delete (tackon #dest-dir "base/players/male/utsoldier.m8"))
		(delete (tackon #dest-dir "base/players/male/utsoldierdmg.m8"))
		(delete (tackon #dest-dir "base/players/male/utsoldier_i.m8"))
		(delete (tackon #dest-dir "base/players/female/velvet.m8"))
		(delete (tackon #dest-dir "base/players/female/velvetdmg.m8"))
		(delete (tackon #dest-dir "base/players/female/velvetp1.m8"))
		(delete (tackon #dest-dir "base/players/female/velvetp1dmg.m8"))
		(delete (tackon #dest-dir "base/players/female/velvetp2.m8"))
		(delete (tackon #dest-dir "base/players/female/velvetp2dmg.m8"))
		(delete (tackon #dest-dir "base/players/female/velvet_i.m8"))
		(delete (tackon #dest-dir "base/players/female/unseenhand.m8"))
		(delete (tackon #dest-dir "base/players/female/unseenhanddmg.m8"))
		(delete (tackon #dest-dir "base/players/female/unseenhand_i.m8"))
		(delete (tackon #dest-dir "base/players/female/unseenfem.m8"))
		(delete (tackon #dest-dir "base/players/female/unseenfemdmg.m8"))
		(delete (tackon #dest-dir "base/players/female/unseenfem_i.m8"))
		(delete (tackon #dest-dir "base/players/female/darkelfw.jpg"))
		(delete (tackon #dest-dir "base/players/female/darkelfw.m8"))
		(delete (tackon #dest-dir "base/players/female/darkelfwdmg.m8"))
		(delete (tackon #dest-dir "base/players/female/darkelfw_i.m8"))
		(delete (tackon #dest-dir "base/skins/female/darkelfw.jpg"))
		(delete (tackon #dest-dir "base/skins/female/darkelfw.m8"))
		(delete (tackon #dest-dir "base/skins/female/darkelfwdmg.m8"))
		(delete (tackon #dest-dir "base/skins/female/darkelfw_i.m8"))
		(delete (tackon #dest-dir "base/skins/female/velvet.m8"))
		(delete (tackon #dest-dir "base/skins/female/velvetdmg.m8"))
		(delete (tackon #dest-dir "base/skins/female/velvetp1.m8"))
		(delete (tackon #dest-dir "base/skins/female/velvetp1dmg.m8"))
		(delete (tackon #dest-dir "base/skins/female/velvetp2.m8"))
		(delete (tackon #dest-dir "base/skins/female/velvetp2dmg.m8"))
		(delete (tackon #dest-dir "base/skins/female/velvet_i.m8"))
		(delete (tackon #dest-dir "base/skins/female/unseenfem.m8"))
		(delete (tackon #dest-dir "base/skins/female/unseenfemdmg.m8"))
		(delete (tackon #dest-dir "base/skins/female/unseenfem_i.m8"))
		(delete (tackon #dest-dir "base/skins/female/unseenhand.m8"))
		(delete (tackon #dest-dir "base/skins/female/unseenhanddmg.m8"))
		(delete (tackon #dest-dir "base/skins/female/unseenhand_i.m8"))
		(delete (tackon #dest-dir "base/skins/male/utsoldier.m8"))
		(delete (tackon #dest-dir "base/skins/male/utsoldierdmg.m8"))
		(delete (tackon #dest-dir "base/skins/male/utsoldier_i.m8"))
		(delete (tackon #dest-dir "base/skins/male/gandhig.m8"))
		(delete (tackon #dest-dir "base/skins/male/gandhigdmg.m8"))
		(delete (tackon #dest-dir "base/skins/male/gandhig_i.m8"))
		(delete (tackon #dest-dir "base/players/male/oberon.m8"))
		(delete (tackon #dest-dir "base/players/male/oberondmg.m8"))
		(delete (tackon #dest-dir "base/players/male/oberon_i.m8"))
		(delete (tackon #dest-dir "base/players/male/thug.m8"))
		(delete (tackon #dest-dir "base/players/male/thug1.m8"))
		(delete (tackon #dest-dir "base/players/male/thugdark.m8"))
		(delete (tackon #dest-dir "base/players/male/thugdarkdmg.m8"))
		(delete (tackon #dest-dir "base/players/male/thugoom.m8"))
		(delete (tackon #dest-dir "base/players/male/thugoomdmg.m8"))
		(delete (tackon #dest-dir "base/players/male/tinker2.m8"))
		(delete (tackon #dest-dir "base/players/male/tinker2dmg.m8"))
		(delete (tackon #dest-dir "base/players/male/tinker2_i.m8"))
		(delete (tackon #dest-dir "base/players/male/titanb.m8"))
		(delete (tackon #dest-dir "base/players/male/titanj.m8"))
		(delete (tackon #dest-dir "base/players/male/titank.m8"))
		(delete (tackon #dest-dir "base/players/male/titanl.m8"))
		(delete (tackon #dest-dir "base/players/male/titant.m8"))
		(delete (tackon #dest-dir "base/skins/oberon.m8"))
		(delete (tackon #dest-dir "base/skins/oberondmg.m8"))
		(delete (tackon #dest-dir "base/skins/oberon_i.m8"))
		(delete (tackon #dest-dir "base/skins/OGLE.m8"))
		(delete (tackon #dest-dir "base/skins/ogleDmg.m8"))
		(delete (tackon #dest-dir "base/skins/OGLE_I.m8"))
		(delete (tackon #dest-dir "base/skins/ti.m8"))
		(delete (tackon #dest-dir "base/skins/ti2.m8"))
		(delete (tackon #dest-dir "base/skins/ti2dmg.m8"))
		(delete (tackon #dest-dir "base/skins/ti3.m8"))
		(delete (tackon #dest-dir "base/skins/ti3dmg.m8"))
		(delete (tackon #dest-dir "base/skins/tidmg.m8"))
		(delete (tackon #dest-dir "base/skins/tinker2.m8"))
		(delete (tackon #dest-dir "base/skins/tinker2dmg.m8"))
		(delete (tackon #dest-dir "base/skins/tinker2_i.m8"))
		(delete (tackon #dest-dir "base/skins/titanb.m8"))
		(delete (tackon #dest-dir "base/skins/titanium.m8"))
		(delete (tackon #dest-dir "base/skins/titaniumdmg.m8"))
		(delete (tackon #dest-dir "base/skins/titanj.m8"))
		(delete (tackon #dest-dir "base/skins/titank.m8"))
		(delete (tackon #dest-dir "base/skins/titanl.m8"))
		(delete (tackon #dest-dir "base/skins/titant.m8"))
		(delete (tackon #dest-dir "base/skins/Tontoreblack (1).m8"))
		(delete (tackon #dest-dir "base/skins/TontoreblackDmg (2).m8"))
		(delete (tackon #dest-dir "base/skins/tonyatest.m8"))
		(delete (tackon #dest-dir "base/skins/nude chicken.m8"))
	)
  )
)
)
)

(procedure P_DoInstallMods
(
  (DepackMod "maps.hpa" (tackon #dest-dir "base/maps"))
		(working "Installing Maps ...")
		(set #status
   	 		(run #cmdline
				(help @run-help)
   	 		)
		)

		(if (= #status 2)
   			 (
				(exit #user-abort (quiet))
   	 		)
		)

  (DepackMod "Models.hpa" (tackon #dest-dir "base/models"))
		(working "Installing Models ...")
		(set #status
   	 		(run #cmdline
				(help @run-help)
   	 		)
		)

		(if (= #status 2)
   			 (
				(exit #user-abort (quiet))
   	 		)
		)

  (DepackMod "pics.hpa" (tackon #dest-dir "base/pics"))
		(working "Installing pics ...")
		(set #status
   	 		(run #cmdline
				(help @run-help)
   	 		)
		)

		(if (= #status 2)
   			 (
				(exit #user-abort (quiet))
   	 		)
		)

  (DepackMod "players.hpa" (tackon #dest-dir "base/players"))
		(working "Installing Players ...")
		(set #status
   	 		(run #cmdline
				(help @run-help)
   	 		)
		)

		(if (= #status 2)
   			 (
				(exit #user-abort (quiet))
   	 		)
		)

  (DepackMod "skins.hpa" (tackon #dest-dir "base/skins"))
		(working "Installing Skins ...")
		(set #status
   	 		(run #cmdline
				(help @run-help)
   	 		)
		)

		(if (= #status 2)
   			 (
				(exit #user-abort (quiet))
   	 		)
		)

  (DepackMod "sound.hpa" (tackon #dest-dir "base/sound"))
		(working "Installing Sound ...")
		(set #status
   	 		(run #cmdline
				(help @run-help)
   	 		)
		)

		(if (= #status 2)
   			 (
				(exit #user-abort (quiet))
   	 		)
		)

  (DepackMod "sprites.hpa" (tackon #dest-dir "base/sprites"))
		(working "Installing Sprites ...")
		(set #status
   	 		(run #cmdline
				(help @run-help)
   	 		)
		)

		(if (= #status 2)
   			 (
				(exit #user-abort (quiet))
   	 		)
		)

  (DepackMod "textures.hpa" (tackon #dest-dir "base/textures"))
		(working "Installing Textures ...")
		(set #status
   	 		(run #cmdline
				(help @run-help)
   	 		)
		)

		(if (= #status 2)
   			 (
				(exit #user-abort (quiet))
   	 		)
		)
)
)

(procedure DepackMod arg1 arg2
	(set #cmdline
		(cat
	    		"bin/hUnpackOS4 -archive \""
	    		(tackon "Data/" arg1)
	    		"\" -dest \""
	    		arg2
	    		"\""
	 	)
    	)
)

(set #dest-dir
	(askdir
		(prompt #dest-prompt)
		(default @default-dest)
		(help @askdir-help)
    	)
)

(set @default-dest #dest-dir)

(P_DoRunFixScript)
(P_DoInstallConfig)
(P_DoInstallMods)

(complete 100)

(delete "t:hunpackOS4")


(set #ver (/ @installer-version 65536))
(if (>= #ver 44)
    (
	(effect "lower_right" "radial" $C85037 $000000)
    )
)

(if (< #ver 43)
    (
	(exit "Your Installer is too old. Get a new version from Aminet" (quiet))
    )
)
