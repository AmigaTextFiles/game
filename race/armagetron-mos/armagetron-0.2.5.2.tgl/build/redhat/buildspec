#!/bin/sh
VERSION=$( cat version )

echo "define(VERSION,$VERSION)">  preset.m4
echo "define(CONFIGURE_OPTIONS,)"  >> preset.m4
echo "define(RPMBUILDROOT,$RPMBUILDROOT)" >> preset.m4
echo "define(PREFIX,$PREFIX)" >> preset.m4
echo "define(PROGNAME,$PROGNAME)" >> preset.m4
echo "define(PACKAGENAMEBASE,$PACKAGENAME)" >> preset.m4
echo "define(PACKAGER,$PACKAGER)" >> preset.m4
echo "define(RELEASE,$RELEASE)" >> preset.m4
echo "define(CONFIG,$CONFIGFILES)" >> preset.m4

if [ "$DEDICATED" == "yes" ]; then
  echo "define(PACKAGENAME,$PACKAGENAME_dedicated)" >> preset.m4
  echo "define(DEDICATED,yes)" >> preset.m4
else
  echo "define(PACKAGENAME,$PACKAGENAME)" >> preset.m4
  echo "define(DEDICATED,no)" >> preset.m4
fi

cat preset.m4 armagetron.spec.m4 | m4 > armagetron.spec

rm -rf preset.m4
