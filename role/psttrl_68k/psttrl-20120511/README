(for emacs users, this document is best in the -*- outline -*- mode)

psttrl --- kill a dragon with your favorite weapon
by Oohara Yuuma <oohara@libra.interq.or.jp>

* what is psttrl

psttrl is Professional Sword Tester the Roguelike, a dungeon exploring
game where choosing a weapon is very important.  Both you and monsters
use weapons.  See how the combination of monsters and weapons works.
You can use the combination for yourself by casting the spell of
polymorph self.

* system requirement

psttrl must be run in a terminal.  Its size must be 80x24 or larger.
It must support colors.  Its size must not be changed during the game.

* command line options

** --save-dir _directory_

Save and load the game in this directory.  To see what the default save
directory is, use the --help option.

** --help

Print the help message and exit.

** --version

Print the version information and exit.

** --cheat-color-by-threat

Choose the color of the symbol of monsters by their threat:
  + purple: the monster can kill the player character with one attack
    and the player character can't kill the monster with one attack
  + red: the monster can kill the player character with one attack
  + yellow: the player character can't kill the monster with one attack
Although this option considers the ability of characters and weapons,
it is not perfect:
  + the option assumes that the combat is done in the current position
    of the player character and the monster, which is not true unless
    they are adjacent to each other
  + although the option considers both a normal attack and a post-move
    attack, it doesn't tell you which attack is better
  + the option doesn't consider killing the opponent by reflecting
    its attack
  + the option doesn't consider the result of the combat other than death
  + your action (including attacking) may change the result of the combat
    in monster turns
  + the option doesn't work if the player character is dead
This is a cheat option.  It gives you information about monsters
even if they are behind a wall.  Winning the game with this option is
not a true victory.  This option is automatically enabled if the game is
loaded from a saved game which uses this option.

* premise

What is the best weapon?  Killing a dragon will answer it.

* victory condition

You can win in 2 ways:
  + Kill the Ancient Dragon.
  + Kill one of the dragons other than the Ancient Dragon and
    return to the surface floor.
You don't need to use a weapon to kill a dragon and you don't need to
keep any weapon.  There is no time limit.

* turn-based move

All actions are handled one by one.  If it is your turn, monsters don't
move until you decide your action.

A turn refers to the amount of time taken by one action.  The length of
a turn in the game time depends on what the action is and who do
the action.  Usually all actions take the same amount of time and
you and monsters move at the same speed.

All effects of actions happen immediately.  For example, if you decide
to climb down a stair, you don't stay in the current floor until your
next turn; you enter the next floor now and end your turn.  This means
that monsters in the next floor will move before your first action in
that floor.

* statistics

The ability of you and monsters is described in numbers:

** hit point (HP)

If you take damage, you lose your hit points.  If your hit point
is negative, you die.  Note that you are alive if your hit point is 0.

** max hit point (MHP)

You can't have more hit points than your max hit points.

** strength (STR)

If you have more strength, your attack is more powerful.

** level

Your level is the bonus added to your max hit point and your strength.
It is always shown with the name of a character.  For example,
"+0 sword tester" means a sword tester of level 0.  Note that a level
can be negative.

You gain a level in 2 ways:
  - descend 2 floors
  - kill a dragon

** defense point (DEF)

If you have more defense points, you can bear attacks to you better.
Defense points are calculated in each combat.

** attack point (ATK)

Your attack points is the power of your attack.  Attack points are
calculated in each combat.

* weapons

You can use one equipment.  Since you can change your equipment
very quickly, every equipment is called as "weapon" and using
an equipment is always called as "wielding".

To wield a weapon, you must carry it first. To carry a weapon,
you must put it in one of your weapon slots. You have 4 weapon slots.
Each slot can have only 1 weapon.

Monsters can carry and wield a weapon.  Monsters have only 1 weapon slot.

** pick up a weapon

You can pick up a weapon by pressing the [g] key or the [,] key, then
choosing a weapon slot with the direction keys.  If the weapon slot
already has a weapon, you can drop the old weapon and pick up the new
weapon in the same turn.  If there are 2 or more weapons on the floor,
you can choose which weapon to pick up by pressing the [+], [space]
or [-] key.

If there is a weapon at the current position of the player character,
its name is shown in the upper-right part of the window (below
the depth of the current floor).  If there are 2 or more weapons,
only one of them is shown.

** drop a weapon

You can drop a weapon you are carrying by pressing the [d] key,
then choosing a weapon with the direction keys.  If 2 or more weapon are
put in the same grid, they are in a random order.

** wield a weapon

To wield a weapon, you must mark one of the weapon slot as "wielding".
You automatically wield the weapon in that slot.  The wielding
weapon slot is marked with an asterisk ('*').

You can change the wielding weapon slot by pressing the [w] key,
then choosing a weapon slot with the direction keys.  You can choose to
wield nothing and just carry weapons by pressing the [.] key or
the [5] key.  Changing the wielding weapon slot does not take a turn.

* empty slot bonus

You get 1 point of bonus added to your defense points and attack points
for each empty weapon slot.  Monsters get 1 point of this bonus if
they don't wield a weapon.

* map symbols

Your character is shown as an at-sign ('@').

Alphabets are monsters you can see.  Question marks ('?') are monsters
you can't see but you feel they are there.

.  floor
#  wall
<  up stair
>  down stair
/  weapon

* command

All commands are case-sensitive.  Use the shift key as appropriate.

  b  move down-left
  c  (cancel)
  d  drop weapon
  g  pick up weapon
  h  move left
  j  move down
  k  move up
  l  move right
  m  full-screen map
  n  move down-right
  o  (confirm)
  p  message log
  t  throw weapon
  u  move up-right
  v  view player character and weapon description
  w  change wielding weapon slot
  x  examine surroundings
  y  move up-left
  z  cast the spell of polymorph self

  Q  resign the game without saving
  S  save the game and exit

  5  stay during 1/2 time of a normal action; end post-move attack
  .  stay during 1/2 time of a normal action; end post-move attack
  ,  pick up weapon
  <  climb up/down a stair
  >  climb up/down a stair

* cancel a command

If a command doesn't decide your action, you can cancel the command
by pressing the [c] key.  Note that the [escape] key is not supported.

* save the game

You can save the game by pressing the [S] key.  You can save any number
of times, but each character can have only one save file; if you save,
an old save file is always overwritten.  Use the --help option to see
where the save file is created by default.

Saving is only for suspending; each save file can be loaded only once.

If you want to quit the game without saving, you must resign the game;
press the [Q] key, then press the [o] key to confirm.

* move or attack

Use the vi-like key binding ([hjklyubn]), the number keys or the cursor
keys to move.  The numpad can also be used as long as it is configured
to enter a number.

When you try to move to a position a monster is blocking, you attack
the monster instead of moving.  You remain at the current position
this turn even if the target is killed.  Note that the range of
an attack is always 1 even if you wield something which looks like
a ranged weapon.

* post-move attack

A post-move attack is an attack done as an additional action of a turn.
In other words, when you do a post-move attack, you move and attack
in the same turn.  It takes as much time as just moving.

Some weapons allow you to do a post-move attack.  If you can do
a post-move attack, your surroundings are shown in the bold font.
When you move, if a monster is adjacent to you, the game automatically
asks you the direction of a post-move attack.  The direction of
the move and the direction of the post-move attack need not be the same.
You can choose not to do a post-move attack by pressing the [.] key or
the [5] key.  Note that the move can't be canceled.

Monsters can use a post-move attack.  Some monsters can do a post-move
attack without any weapon.

* view your character and your weapon

You can view your character and your weapon by pressing the [v] key.
The max hit points and strength shown in this way are calculated
as if you were level 0; your level is added to them.

Use the direction keys to view other weapons you are carrying.
Pressing the [w] key changes the wielding weapon slot so that
you wield the weapon you are viewing.

* target a monster with the cursor

Information about the monster under the cursor is shown in the right part
of the map (below information about you).  The cursor moves to a near
monster automatically.  You can move the cursor to a different monster
near you by pressing the [space] key.

* examine surroundings

You can examine monsters, weapons and terrains near you by pressing
the [x] key.  Use the direction keys to move the cursor to what you want
to examine.  To read a monster description, press the [v] key while
the cursor is on the monster.  (To read a weapon description on a floor,
you must pick it up first.)  The max hit point and strength shown
in this way are calculated as if the monster were level 0; the level
of the monster is added to them.  If a stair is in your sight, you can
examine its destination by pressing the [<] key or the [>] key while
the cursor is on the stair.

* climb up/down a stair

If you are on a stair, you can use it by pressing the [<] key or
the [>] key.  Both keys are accepted; you don't have to choose the same key
as the symbol of the stair.

If the destination of the stair is blocked by a monster, you attack
the monster instead of climbing.  You remain on the current floor this turn
even if the target is killed.

Monsters can climb a stair.  If you are blocking a stair a monster is
climbing, you are attacked and noticed.  Using the examine surroundings
command ([x]) near a stair will help you (use the [</>] key).

* monster intelligence

Monsters are not as smart as you.
  + Monsters always wield the weapon they are carrying.
  + Monsters don't pick up or drop a weapon.
  + The sight range of monsters is slightly shorter than yours.
  + Monsters don't ask others for help when they find you.
  + Monsters get tired if they chase you too long.

* throw a weapon

You can throw a weapon you are carrying by pressing the [t] key,
then pressing one of the direction keys. The range of the throw is 8.

If a thrown weapon hits a monster, the current weapon of the monster
is destroyed.  The monster catches the thrown weapon and wields it.
Unfortunately, this partially damages the thrown weapon.
The thrown weapon is destroyed when its owner (the target monster
of the throwing) is killed.

You can't attack a monster by throwing a weapon.  Throwing a weapon is
useful if you want to deal with the weapon of a monster or if you
want to put an useless junk in the hand of a monster.

* combat sequence

A combat is handled in this way:
  + Calculate the defense points and attack points before the combat
    begins.  These values are shown in the status information.
    These values are based on:
    - hit points and strength (The defense points are equal to the hit
      points.  The attack points are equal to the strength, including
      the level bonus.)
    - the modifier of a weapon
    - empty slot bonus
  + Check what ability of characters and weapons can affect the combat.
    If a character or weapon has such an ability, it is always applied
    even if it is against the owner.  If there are 2 or more similar
    abilities, they are applied in this order:
    - the attacking character
    - the attacked character
    - the weapon of the attacking character
    - the weapon of the attacked character
    When an ability says "you", it refers to the owner of the ability,
    not necessarily the player character.
  + Calculate the defense points and attack points in this combat.
  + Check if the attack is accurate or critical.  Check if the attack is
    reflected, dodged or parried (see below).
  + If the attack is not reflected or dodged, compare the attack points
    of the attacking character and the defense points of the attacked
    character:
    - If the attack points are equal or greater than the defense points,
      the attacked character dies.
    - Otherwise, the attacked character loses 1 hit point.  Note that
      the hit point loss here does _not_ depend on the attack points;
      the loss is always 1.
  + If the attack is not reflected, dodged or parried, apply the additional
    effect of the attack, including critical.

* special attack and defense

** reflect

If an attack is reflected, the attack points of the attacking character
is compared with the defense points of the attacking (not attacked)
character.  The attacking character dies or loses 1 hit point
accordingly.  The additional effect of the attack is not applied.

** dodge

If an attack is dodged, the attacked character doesn't die or lose
hit points.  The additional effect of the attack is not applied.

** parry

If an attack is parried, its additional effect is not applied.
The attacked character can still die or lose 1 hit point.

** accurate

If an attack is accurate, it can't be dodged or parried.
It can still be reflected.

** critical

If an attack is critical, it has an additional effect: the attacked
character dies.

* kill and heal

You and monsters don't regenerate; you don't gain hit points just because
time passes.  When you kill an enemy, you gain hit points to the maximum.

* polymorph self

Your character can cast a spell of polymorph self.  It permanently
changes your character into the monster your character killed last.
Press the [z] key to remember the last kill, then press the [o] key
to actually cast the spell.

The spell of polymorph self costs 1 level and the memory of
the last kill.  You can't cast it if your level is negative.
If you cast it, you must kill another monster to cast it again.

* contact information

Please send bug reports or comments to Oohara Yuuma
<oohara@libra.interq.or.jp>.  Also check the psttrl webpage:
http://www.interq.or.jp/libra/oohara/psttrl/index.html

* history

The first version of psttrl was released on Sat, 17 Mar 2012.
It was written for The 2012 Seven Day Roguelike Challenge
(http://roguebasin.roguelikedevelopment.org/index.php/7DRL_Contest_2012),
which was held on the rec.games.roguelike.development newsgroup.

The game was named after a post on the rec.games.roguelike.development
newsgroup (http://groups.google.com/group/rec.games.roguelike.development/msg/d84fc34513e4b018).
It discussed how to see which weapon was better than others.
