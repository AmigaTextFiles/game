
                            NameThatMonster  1.0
                               1 Feb 1993

                                WHAT IT DOES
     NameThatMonster is a Commodity for use with a three button mouse and
the game Moria and similar games.  It allows you to identify a monster or
object with a single click of the middle mouse button.
     Normally in Moria you can identify a monster by pressing the slash key
and then clicking on the monster with the left mouse button.  If you are
like me, you do this a lot.  Gets tedious, doesn't it?  Now, you can do it
with a single press of the middle mouse button.  Through the magic of the
commodities.library, NameThatMonster translates the middle mouse button
click into a press of the slash key and a click of the left mouse button.

                                   USAGE
     Run it from the Shell or from the Workbench.  I run it in a script in
the Moria: directory that looks like this:
          if not exists Moria:
            assign Moria: ""
            run >nil: NameThatMonster
          endif
          stack 150000
          moria
          stack 4000
     To kill NameThatMonster, either 1) run it again, or 2) use the Exchange
utility to kill it, or 3) send it a ctrl-C or ctrl-E, using the BREAK
command if necessary.
     NameThatMonster takes one optional command line argument or ToolType,
CX_PRIORITY=, which is the usual Commodity priority.

                             PROGRAMMER'S NOTES
     This one was surprisingly difficult to write.  The commodities.library
contains several functions that make it easy to use mouse buttons as
qualifiers to another keypress, so that it is fairly straight-forward to
write a Commodity that will, for instance, treat the middle button as a
substitute for the shift key.  For this program, though, I wanted to use the
mouse buttons not as qualifiers but as keypresses in their own right, and to
do this I had to do a lot of low-level programming by hand.  In particular,
I had to create my own chain of input events.
     Still, that would not have been difficult if only the ROM Kernal Manual
told the truth, but instead it lies like a rug.  I wanted to make a
Translator Object that would convert a midbutton event into a slash key
event and a leftbutton event.  The InputEvent structure has a field named
NextEvent, and, poor innocent that I was, I assumed that the first event
would use this field to hold a pointer to the second event, and that I would
point the Translator Object to the first event.  Was I ever wrong!  After a
great deal of trouble, I finally discovered that the Translator Object takes
a pointer to the last event in the chain; the last event uses the NextEvent
field to hold a pointer to the previous event, which then uses its NextEvent
field for a pointer to the event previous to it, and so on back to the first
event, which has a null in its NextEvent field.  The Libraries manual says
nothing about this under Translator Objects, but does contain a single
cryptic comment about AddIEvents(): "Note that if passed a linked list of
input events created by InvertString(), the order the events appear in the
string will be reversed." Apparently InvertString() links InputEvents
together in the reverse order that the Translator Object expects.  Since
InvertString() cannot handle leftbutton events, this was no use to me.

                                 ENVOI
     Perhaps all this backwards programming was good preparation for the
lower depths of Moria, where the Large Green Leprechauns are invisible,
despite being green.  I hope this program helps you in your hunt for the
Balrog.  If it gives you any problems (and they could not be half as bad as
the problems it gave me), please write to me:

          Douglas Nelson
          2006 N. 49 Avenue
          Omaha NE 68104
          USA

By the way, this program is freely distributable.
