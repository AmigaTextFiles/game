Visibility

Much of this is already sorted out:

if (test_inLOS(x,y))
{
    if (hasmonster(x,y)) draw_monster(x,y);
    else if (hasitem(x,y)) draw_item(x,y);
    else draw_tile(x,y);
    mark_seen(x,y);/*Only memorises tiles. How do we memorise objects?*/
} else /* draw anything in memory*/
 if (test_seen(x,y)) draw_tile(x,y);
 else draw_nowt(x,y); /*blank it!*/

NB-This was just pseudocode, the real one would be done better,
and indeed, most of it is already done.

Also remembered later: With this visibility code, we can remotely see
doors we've seen before get opened and closed. Hmm.

