CODING STYLE for Porrog
=======================

Just in case anybody gets the urge to contribute anything (so far I've
had a patch, which was appreciated, although I've not actually looked
that closely at it or applied it to my source tree *yet*, but it's
available on the site for those that need it).

Porrog is written in plain old C, not C++. I'm sure *some* of the OOP
style constructs could be handy in places, but overall I find C++
syntax to be immensely confusing, and that it obfuscates how the code
will turn out. Also I wanted the binary to be under a terabyte ;)

I'm trying to keep roughly ANSIish, but traditional ANSI. No C99isms.
In particular, local variable declarations belong at the *start* of a
function, not scattered all over the place! Also, no declarations inside
blocks please, they make it a PITA to trace the variables in my experience.

Structure element names begin with capitals. AFAIK this is pretty unusual,
but I like it that way for some reason *shrug*

Structures, unions, and enums should be typedeffed. In some cases I've had
to use constructions such as
  struct foo_t {struct foo_t *Next};
  typedef struct foo_t foo_t;
to be able to get things done. There, the struct foo_t is simply necessary
for making the declaration and doesn't want to be used. So don't, please!

Functions *used* to be named some_function_name() but I'm now using
the someFunctionName() form because I found the other to be awkward. Most
existing functions still use the old names, but are gradually being changed
over. All new functions should use the new form.
*exceptions* to this rule, are those functions beginning with p_ or m_
(for player or monster respectively), wherein that single underscore should
remain. The rest of those functions' names should follow the same pattern
however, eg: the new function p_tryEat().

Indentation style is pretty ad-hoc I'm afraid. I usually have around 3 or
4 spaces indentation. I don't like it shallower unless the nesting is
getting very deep (which I'm not wild about anyway), and I don't like it
much bigger (7 spaces or so is too many for me). Eventually I'll probably
end up using the "indent" program but I've not got around to investigating
that yet- keeping indentation consistent hasn't really concerned me that
much as yet, although keeping each function *readable* has (not that I've
managed very well in many cases :P).

I've tried to split many bits of code to use various smaller, primitive
functions (eg: p_pickup() now uses skim_item() and p_get(), as explained
in the FUNCTIONS file), but SOME functions are stubbornly enormous and
don't seem willing to suggest ways in which they could be split. I found
these functions confusing enough when I was writing them in the first
place, and now I'm not sure I could maintain them properly!! FWIW I *did*
try to split them up but what I managed didn't make them any less huge! I
also did much planning-out on paper, and tied my brain in knots :P

Because I'm not *totally* depraved, I've tried to avoid "gotos" as much as
possible, but there's one or two in the code, in some of the more massive
functions IIRC. Sorry, I only ever used BASIC until I was 18 (and I started
coding quite young so it's hard to shake the old habits...)! :(  If I can
unravel these more horrific functions, I may be able to extract them to
make the code goto-free ...meanwhile I don't believe that *they* are the
cause of the relevant functions' spaghettiness.

Some of the header files I've tried to split prototypes from type
declarations, etc. In the cases where I have, I've got the type declarations
in files foo_t.h, and the prototypes/function declarations/whatever you
want to call them in files foo_p.h. There's also declarations of global
variables (using "extern"), IIRC these are always (?) in the foo_p.h files.

I have a few global and static variables. So sue me. There's far too much
data to be passing around as function arguments, and I don't want to be
getting to every single bit of it through stupid accessor functions, just
to appease somebody obsessed with coding methods that assume the programmers
only know 1 small portion of the program.

I try to comment my code, but most of my comments end up kind of useless.
I also tend to comment out stuff that doesn't seem right because I'm not
sure if it *was* right (because I hadn't put comments on confusing code ;) )
and also a lot of my old comments seem to end up absolutely confusing
regarding WTF they are referring to. The overall effect is *not* good,
sorry, it's a symptom of me being somewhat scatterbrained. In most cases
I should find the time to go through the code and clean these things up.


More notes on Porrog's de facto coding style as it occurs to me ;)

