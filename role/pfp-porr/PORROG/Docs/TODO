NOTE that I've now got a set of domain-specific TODO's
in the directory NOTES/TODOs/

Eventually, most basic things should be moved there, leaving this for
just higher-level targets?

Also, where I'm not sure if something's done or not, I'm now putting the
parts I think need checking/fixing in NOTES/TODOs/Fix+check, and
REMOVING the rest from here.

Todo list- Immediate:
=====================

ACTUALLY fix that OSX bug!!!! DOH!
  --I think I've now done that at last. I'd previously only fixed it for
    one of the functions it appeared in.

Fix bug with taking mergable items from container?!

Sort out the item sorting function nextItemByGroup() or whatever its
 called. Might need a "head" argument to take whole list into account.
 Then use it to reimplement displayHeap() properly.
 --DONE, new function is displayHeapV2(), might rename it to itemList().

Sort out the "if I can select N of an item through a generic
 displayHeap(), how do I deal with splitting heaps I don't want split?"
 question. I *think* caller should be able to specify when it's not OK.

Fix debug mode to allow you to *browse* the buglog like the MRB; Add
 simple function to dump a little 5X5 screenshot centred around a given
 map square, ignoring visibility and just giving contents, that puts it
 in the buglog (as Information? Or Debug??). Have certain bugs like the
 monsters getting stuck bug, or even the map building bug, call this
 function!!! Could investigate the bugs as they happen :)

Fix the monster spawning- I realise now I'd put (squiggle)^2, which
 of course actually means (squiggle)XOR 2. I should have put
 pow(squiggle,2) or similar.
 --DONE. Actual formula probably needs reanalysing now it's clear how
  badly wrong it'd been before

Modify weapon types
 --DONE, but they suck so far; see notes in NOTES/TODO/GameMechanics

Create a very very very basic wilderness level (for 0.06?). Possibly
just a 40x40 square? Or even a 18x18 square ;) All it should have is
the stairs down; it should be just to cap the top of the dungeon.

Add fancy ASCIIfied lineart screens. Needs a function that loads
simple bitmaps (I chose PBMs) into memory, and a function that can
convert it into ASCII as though the bitmap was expressed as vectors,
etc; Bitmap files should be 80x24, although border pixels will not
be drawn (but they'll take part in the shape calculations).
Also needs function to create simple table to convert bit patterns
into characters.
--DONE mostly, but a long job, and the table creation has been tough.
--Compoarisons are now changed, need to add some final ones for '4's
  in the code. Running ./porrog currently shows a big list of symbols
  for each bit pattern. 'p' key in game displays a test screen with
  various patterns rendered. Some are clearly *wrong*.

Make game show a splash screen at start, and when you die.
  --DONE! Splash is crap though, and skeleton looks...dubious.

Implement time stuff:
 -Have player+monster tickers initialised properly
  --Yes, not sure if monster's ticker is done appropriately
 -Have player/monster action dependent on ticker value
  --Yep.
 -Have cycle duration based on duration of player's action
  --Yep, not sure if minimum time chosen appropriately.
  Could also want to do "continue" if cycledur==0...
 -Have player/monster tickers updated by cycle duration
  --Yep.
 -Eventually, change player action functions to return time taken
  --Not yet.

Add "closed door" item type for doorways, with one instance, not on
 levelwide items list.
 --DONE, and p_open_door, etc all work very nicely now!

Change various function names from function_name() form to functionName()
 because it's less ambiguous usually.
 --Starting with the new functions, anyway. May leave p_foo and m_foo
 as they are??

Start on support for remembering level layout: each room should have
 a byte to describe which parts of it have been seen. One bit should
 say "player has entered room", in which case all the walls have been
 seen... Unless room is partly dark, in which case that shouldn't be
 set? Other bits can represent corners... Tunnels should have a char
 to do likewise, but interpretation would take into account their
 linearity. Memory of objects (and door status!!) should be patchy.
 Perhaps remember first and last items on a level? And most recent
 door (rest should be remembered in *random* state). Doors and items
 should be stored with dlevel structs- itemtype_t *'s for items and
 a byte for doors. Oh, which ones? I dunno. Ha- 4 bytes: store 2
 room no's and 2 bitmaps. The rooms *shouldn't* include the most
 recently used one, which (loops notwithstanding) we'll see when we
 reenter the level. Crap, is remembering door status even *worth it*?
 They wouldn't thank me for it... :P


Todo list- Not quite as immediate:
==================================

Simple traps (shock traps or something, just hurt)

Give land plankton and vampire crabs natural armour (not full coverage,
 obviously). Should this be treated as equipment, or have elements
 in the monster structure for it? If it's stored as equipment items,
 it'll surely be left over! Would that be bad? Or would it actually
 be cool?

Make sure the player can only get killed once, and that when you quit
 (for whatever reason), the monsters don't continue to act before the
 game exits. Requires use of the quitting variable, and possibly a
 playerdead variable?

Have different messages for different proportions of damage absorbed
 by armour. EG: It blocks most of the damage VS It stops a bit of
 the damage, etc.

Rearrange this TODO list

Tweak settings of the AI cache replacement thingy

Tweak settings of the monster annoyance-vs-respect system
 (they preferably shouldn't end up killing each other very often.
 That's the player's job!)

See what has to be done to make it compile under DOS/Windows.

Make the monsters different

Other things I describe as "game mechanics" - such as
 what statistics you have,
   --Decided on a few, physical ones.
 what effects weapons and armour have,
   --Decided on armour effect. Weapons have stopgap.
 how exactly combat works,
   --Sort of done, but needs revision, and shields are treated stupidly
 rebalancing player vs monsters
   --Not touched yet.
 All the stuff that you'd still have if the game wasn't on computer.

Have I said that monsters should be able to go to items in any rooms
 they enter, and consider picking up any items they stand on? Well
 they should. For that matter, when they enter rooms with only one
 entrance, they should properly wander into it rather than just
 stepping through the door and out again. This could hopefully
 be generalised into ai_set_waypoint or something.

Fix the inventory, which screws up if you're carrying too much (looks
 as though the game has hung even though it hasn't: you just have to
 press <space>).

Have items you've already held use their old inventory letters if
 they're still available.

Finish all the help pages.

Improve the dXrng routines such that it has "high-level" dice that
 use "low-level" dice to get the random offsets and list transitions,
 etc whenever a roll list is finished, and only those "low-level" dice
 use the given system RNG function to get those numbers. NB, that system
 RNG function could be based on getting bits out of a text string or
 something equally silly: the deterministicness of such a function
 would get obscured by the low-level dice such that the high-level
 dice would behave quite chaoticly.

Make sure the item stack merging is done everywhere it should be: I
 think it's not done for containers yet.

Allow splitting stacks of items into 2 separate, smaller stacks. Not
 sure of all the circumstances for such things. Also, taking off
 one item at a time (perhaps for using it up) doesn't seem to need
 that support.

Make equivs of describe_item(), item_basename(), for monsters

Give a function that lists all item types you know of (for flavoured items).

Provide way of flagging certain item types as being a quantity of
 stuff (eg, noodles, soup, whatever) rather than individual items,
 so they can be described better.

Shops!

Proper combat routines: see "game mechanics" above.

Ability to make level maps with 2 or more separate areas rather than
 just one. This should already be possible, but I'm not sure exactly
 how to pass the data needed (eg where to put the stairs, etc), or
 whether or not the areas could be guaranteed to be unconnected.
 Reasons: One of the nice bits about Crawl is the way you can have
 separate areas of levels, that can be reached from the level above
 or below, making an effectively 3d maze. I could do that...

Higher-level control of the level maps, such that you can have a top
 level that goes to wilderness, branches, doubling back to go through
 separate parts of existing levels, and separate dungeons (as in branches
 from the wilderness). Could be difficult.

More items that do stuff!! 
  --started with just containers, and now armour too.

Better success/failure messages for doing everything

Find out some way of unreadying ranged-weapons (currently impossible
 because I and my weapon unwielding UI are stupid).

Have equipped items show up in inventory as being equipped

Have inventory (and other item lists) sorted by item group
 -also, perhaps items should go onto the END of inventory list, so
 that they can be listed in the order you got them in... any reason
 why not? Player structure could keep a "lastitem" pointer, to
 avoid having to trawl through the whole list each time.

Change memutils functions to malloc memory several elements at
 a time, and parcel it out from that. Then counting_free shouldnt
 actually free anything until the whole chunk had been released.
 For strings, round up the requested string length to the nearest
 4 or so?

Do all the other "flavoured" items. Already have potions, it isn't
 turning out too hard.

Alter the map generator so that you don't have to run all the way
 round the dungeon to reach somewhere thats only a few squares away.
  --The region based generator allows for this, but not done yet.

Allow player to check features of squares that he stands on or
 that are on screen. Needs features to be describable.
 Also needs a "select some point on the screen" UI function.

Allow the RNG to be initialised with either a specific seed function,
or with the system RNG using a random seed (like the time...) so we
can actually have (shock horror) different games each time!
  -Started.

Change the new item generator to make certain items rarer than others,
and make limit certain items to minimum depths (so you won't find
a grimoire or a chest freezer on level 1)

Allow saving and loading the game (makes the game more meaningful!),
but of course the file format is likely to change whenever something
is added...

Implement monster sleep: when monsters are created, they are asleep;
each turn, they have a 1/N chance of waking up. Each turn they don't
wake up, they have a 1/X chance of getting marginally tougher
(some proportion of their base toughness). Why? 1-It helps make
up for the monster missing the chance to pick up good bits of
equipment, 2-It simulates the regeneratinve effects of sleep! It
should work out that a monster never/rarely becomes more than
2 or 3 times tougher than one that wakes immediately.
When they get toughened up, they should simultaneously get their
experience value raised. When the player is in the vicinity of
the monster, it should be more likely to wake up each turn (do
the check twice? Or double the chance? NB- these are not the
same thing!)
  --No point until the monsters can do stuff
  Ah. Now they can. So...

Further still:
==============

Implement hunger!

Do a tad more optimisation on the slower map building functions in
 maparray.c (which I've already managed to speed up immensely thanks
 to gprof)

The deities (see note IDEA_DEITIES)

Wilderness of some sort.

The rest!!!

