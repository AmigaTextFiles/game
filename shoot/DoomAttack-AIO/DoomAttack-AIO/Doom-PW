;-------------------------------
;Startup script for DoomAttack.
;Game: Doom or The Ultimate Doom
;WAD:  DOOM.WAD,DOOM1.WAD or DOOMU.WAD
;For use with Patch WAD files.
;-------------------------------


IF NOT EXISTS DoomAttack
Echo "*NError: Could not find DoomAttack!"
SKIP DOOMEND
ENDIF

ASSIGN EXISTS T: >NIL:
IF WARN
MakeDir Ram:T
Assign T: Ram:T
ENDIF

ASSIGN EXISTS Env: >NIL:
IF WARN
MakeDir Ram:Env
Assign Env: Ram:Env
ENDIF

Set MainWAD ""
If Exists DOOM.WAD
Set MainWAD DOOM.WAD
EndIf
If Exists DOOM1.WAD
Set MainWAD DOOM1.WAD
EndIf
If Exists DOOMU.WAD
Set MainWAD DOOMU.WAD
EndIf

If "$MainWAD" NOT GT ""
Echo "*NError: Could not find DOOM.WAD, DOOM1.WAD or DOOMU.WAD"
SKIP DOOMEND
EndIf


If NOT Exists Env:D1PWADdir
Echo >Env:D1PWADdir ""
Echo >Env:D1PWADfile ""
 if exists DOOM1-PWADs
 Echo >Env:D1PWADdir DOOM1-PWADs
 endif
EndIf

RequestFile >Env:D1PWADselect DRAWER "$D1PWADdir" FILE "$D1PWADfile" PATTERN #?.WAD TITLE "Select Doom Patch WAD file" NOICONS
If Warn
SKIP DOOMEND
EndIf
 If $D1PWADselect NOT GT ""
 Echo "*NNothing was selected!"
 SKIP DOOMEND
 EndIf
If NOT Exists $D1PWADselect
Echo "*N$D1PWADselect does not exist!"
SKIP DOOMEND
EndIf
 If "`Echo $D1PWADselect LEN 1`" EQ "/"
 Echo "*NNothing was selected!"
 SKIP DOOMEND
 EndIf
If "`Echo $D1PWADselect LEN 1`" EQ ":"
Echo "*NNothing was selected!"
SKIP DOOMEND
EndIf
 List >Env:D1PWADdir $D1PWADselect LFORMAT %P
 List >Env:D1PWADfile $D1PWADselect LFORMAT %N


  Echo ""
  IF EXISTS AddBuffDA
  Execute AddBuffDA
  ENDIF


Stack 20000

DoomAttack -wad $MainWAD -file $D1PWADselect


LAB DOOMEND

