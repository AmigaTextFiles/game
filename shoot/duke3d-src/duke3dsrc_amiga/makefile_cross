###############################################################################
#
#	makefile for a SASC project
#
###############################################################################

NAME         = AmigaDuke3D

###############################################################################

WARN	=
DEF	= -DPLATFORM_AMIGA -DSTUB_NETWORKING
DEBUG	=
OPT	= -O2 -funsigned-char -s -ffast-math -fomit-frame-pointer
CPU	= -m68030 -m68881

INCL	= -I Engine/ -I .

CC	= m68k-amigaos-gcc
CPP	= m68k-amigaos-c++
RM	= rm -f
MKDIR	= mkdir

###############################################################################

LIBS 	= -L/opt/gg/lib -lnix

CFLAGS	= $(CPU) $(WARN) $(OPT) $(INCL) $(DEBUG) $(DEF) -noixemul

###############################################################################

ENGINE	= Engine/amiga_compat.o Engine/a.o Engine/cache1d.o Engine/engine.o	\
	  Engine/mmulti.o Engine/pragmas.o Engine/amiga_driver.o Engine/amiga_display.o

GAME	= Game/actors.o Game/animlib.o Game/config.o Game/control.o Game/game.o \
	  Game/gamedef.o Game/global.o Game/keyboard.o Game/menues.o Game/player.o \
	  Game/premap.o Game/rts.o Game/scriplib.o Game/sector.o Game/sounds.o

AUDIO	= Game/audiolib/amiga_dsl.o Game/audiolib/fx_man.o Game/audiolib/ll_man.o \
	  Game/audiolib/multivoc.o Game/audiolib/mv_mix.o Game/audiolib/mvreverb.o \
	  Game/audiolib/nodpmi.o Game/audiolib/pitch.o Game/audiolib/user.o

###############################################################################

all: $(NAME)

$(NAME):	$(ENGINE) $(GAME) $(AUDIO)
		$(CPP) $(CFLAGS) -o $@ $(ENGINE) $(GAME) $(AUDIO) $(LIBS)
		mv -f duke3d.exe /mnt/amistorage/Duke3D/duke3d.exe 

###############################################################################

clean:
	-$(RM) Engine/*.o
	-$(RM) Game/*.o
	-$(RM) Game/audiolib/*.o
	-$(RM) $(NAME)

###############################################################################

Engine/amiga_compat.o:	Engine/amiga_compat.c Engine/amiga_compat.h
Engine/a.o:		Engine/a.c Engine/build.h Engine/a.h
Engine/cache1d.o:	Engine/cache1d.c
Engine/engine.o:	Engine/engine.c
Engine/mmulti.o:	Engine/mmulti.c
Engine/pragmas.o:	Engine/pragmas.c
Engine/amiga_driver.o:	Engine/amiga_driver.c Engine/amiga_display.h
Engine/amiga_display.o:	Engine/amiga_display.c

Game/actors.o:		Game/actors.c
Game/animlib.o:		Game/animlib.c
Game/config.o:		Game/config.c
Game/control.o:		Game/control.c
Game/game.o:		Game/game.c
Game/gamedef.o:		Game/gamedef.c
Game/global.o:		Game/global.c
Game/keyboard.o:	Game/keyboard.c
Game/menues.o:		Game/menues.c
Game/player.o:		Game/player.c
Game/premap.o:		Game/premap.c
Game/rts.o:		Game/rts.c
Game/scriplib.o:	Game/scriplib.c
Game/sector.o:		Game/sector.c
Game/sounds.o:		Game/sounds.c

Game/audiolib/amiga_dsl.o: 	Game/audiolib/amiga_dsl.c
Game/audiolib/fx_man.o: Game/audiolib/fx_man.c
Game/audiolib/ll_man.o: Game/audiolib/ll_man.c
Game/audiolib/multivoc.o:	Game/audiolib/multivoc.c
Game/audiolib/mv_mix.o:	Game/audiolib/mv_mix.c
Game/audiolib/mvreverb.o:	Game/audiolib/mvreverb.c
Game/audiolib/nodpmi.o:	Game/audiolib/nodpmi.c
Game/audiolib/pitch.o:	Game/audiolib/pitch.c
Game/audiolib/user.o:	Game/audiolib/user.c

