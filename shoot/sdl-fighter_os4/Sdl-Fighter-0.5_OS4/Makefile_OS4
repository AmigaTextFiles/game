#          
#  SDL-Fighter is free software; you can redistribute it and/or modify
#  it under the terms of the GNU General Public License as published by
#  the Free Software Foundation; either version 2 of the License, or
#  (at your option) any later version.
#      
#  SDL-Fighter is distributed in the hope that it will be useful,
#  but WITHOUT ANY WARRANTY; without even the implied warranty of
#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#  GNU Library General Public License for more details.
#          
#  You should have received a copy of the GNU General Public License
#  along with this program; if not, write to the Free Software
#  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
#

PREFIX = 
BIN_DIR = 
PKG = SDL-Fighter

EXE = ${PKG}
CC = gcc

CFLAGS = -O1 -newlib -Wall -Isdk:local/newlib/include/SDL 
LDADD = -newlib -lSDL_mixer -lvorbisfile -lvorbis -logg -lSDL_image -ljpeg -lpng -lz -lm -lSDL -lauto -lunix -lpthread

TEX_DIR = pixmaps
EXP_DIR = ${TEX_DIR}/explosion
SFX_DIR = sounds

INSTALL_PKG_DIR 	= ${PREFIX}/${PKG}
INSTALL_TEX_PKG_DIR 	= ${INSTALL_PKG_DIR}/${TEX_DIR}
INSTALL_EXP_PKG_DIR 	= ${INSTALL_PKG_DIR}/${EXP_DIR}
INSTALL_SFX_PKG_DIR 	= ${INSTALL_PKG_DIR}/${SFX_DIR}

OBJS  =	cuserid.o edge.o  hud.o  main.o  objects.o  other.o BFont/BFont.o
FILES = ${BIN_DIR}/${EXE} ${INSTALL_PKG_DIR}/lvl_des
SFX_FILES = $(shell ls ${SFX_DIR}/*.mod ${SFX_DIR}/*.wav)
TEX_FILES = $(shell ls ${TEX_DIR}/*.png)
EXP_FILES = $(shell ls ${EXP_DIR}/*.png)

all: ${EXE}

${EXE}: ${OBJS}
	${CC} -o ${EXE} ${OBJS} ${LDADD}

install: all in in_sfx in_tex in_exp

in_sfx:
	mkdir -p ${INSTALL_SFX_PKG_DIR}
	@for p in ${SFX_FILES}; do \
	echo "cp $$p ${INSTALL_SFX_PKG_DIR}"; \
	cp $$p ${INSTALL_SFX_PKG_DIR}; \
	done;

in_tex:
	mkdir -p ${INSTALL_TEX_PKG_DIR}
	@for p in ${TEX_FILES}; do \
	echo "cp $$p ${INSTALL_TEX_PKG_DIR}"; \
	cp $$p ${INSTALL_TEX_PKG_DIR}; \
	done;

in_exp:
	mkdir -p ${INSTALL_EXP_PKG_DIR}
	@for p in ${EXP_FILES}; do \
	echo "cp $$p ${INSTALL_EXP_PKG_DIR}"; \
	cp $$p ${INSTALL_EXP_PKG_DIR}; \
	done;

in:
	mkdir -p ${INSTALL_PKG_DIR}
	cp ${EXE} ${BIN_DIR}
	cp lvl_des ${INSTALL_PKG_DIR}

uninstall: un_sfx un_exp un_tex un

un_sfx:
	@for p in ${SFX_FILES}; do \
	if test -f "${INSTALL_PKG_DIR}/$$p"; then \
	echo "rm ${INSTALL_PKG_DIR}/$$p -f"; \
	rm ${INSTALL_PKG_DIR}/$$p -f; \
	fi; \
	done;
	rm -rf ${INSTALL_SFX_PKG_DIR}

un_tex:
	@for p in ${TEX_FILES}; do \
	if test -f "${INSTALL_PKG_DIR}/$$p"; then \
	echo "rm ${INSTALL_PKG_DIR}/$$p -f"; \
	rm ${INSTALL_PKG_DIR}/$$p -f; \
	fi; \
	done;
	rm -rf ${INSTALL_TEX_PKG_DIR}

un_exp:
	@for p in ${EXP_FILES}; do \
	if test -f "${INSTALL_PKG_DIR}/$$p"; then \
	echo "rm ${INSTALL_PKG_DIR}/$$p -f"; \
	rm ${INSTALL_PKG_DIR}/$$p -f; \
	fi; \
	done;
	rm -rf ${INSTALL_EXP_PKG_DIR}

un:
	rm ${FILES} -f
	rm -rf ${INSTALL_PKG_DIR}

clear:
	rm ${OBJS} -f
	rm ${EXE} -f

clean: clear

