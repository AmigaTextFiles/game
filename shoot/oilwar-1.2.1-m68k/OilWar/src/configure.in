AC_INIT(README)
AM_INIT_AUTOMAKE(OilWar, 1.2.1)
AM_CONFIG_HEADER(config.h)
AC_CANONICAL_HOST

AC_PROG_INSTALL
AC_PROG_RANLIB
AC_PROG_CC
AC_PROG_CXX
AC_HEADER_STDC

dnl Check for SDL
SDL_VERSION=1.2.0
AM_PATH_SDL($SDL_VERSION,
            :,
            AC_MSG_ERROR([*** SDL version $SDL_VERSION not found!]))
			
CPPFLAGS="$CFLAGS $SDL_CFLAGS -Wall"
LIBS="$LIBS $SDL_LIBS"

dnl Check for SDL_image
AC_CHECK_LIB(SDL_image, IMG_Load, 
			LIBS="$LIBS -lSDL_image", 
			AC_MSG_ERROR([*** SDL_image library not found!]))
			
dnl Sound settings			
sound_flag=""
AC_MSG_CHECKING([whether to enable sound])
AC_ARG_ENABLE(sound, [  --enable-sound          Enable sound [default=yes]],

if test x$enableval = "xyes"; then
	dnl Check for SDL_mixer
	AC_MSG_RESULT([yes])
	AC_CHECK_LIB(SDL_mixer, Mix_OpenAudio,
			LIBS="$LIBS -lSDL_mixer"; sound_flag="-DSOUND", 
			AC_MSG_ERROR([*** SDL_mixer library not found!]))
	else
		AC_MSG_RESULT([no])
fi,
	AC_MSG_RESULT([yes])
	AC_CHECK_LIB(SDL_mixer, Mix_OpenAudio,
			LIBS="$LIBS -lSDL_mixer"; sound_flag="-DSOUND", 
			AC_MSG_ERROR([*** SDL_mixer library not found!]))
)

AC_SUBST(sound_flag)
			
AC_OUTPUT( Makefile )
