# MakeFile for QuakeTools

.PHONY:  default profile coverage branch all utils install ansi test \
	testprofile testcoverage clean cleanprofile cleancoverage cleanall \
	distclean backup restore

default profile coverage branch all utils install % :
	cd ./src; $(MAKE) -$(MAKEFLAGS) $@;

test testprofile testcoverage:
	cd ./src; $(MAKE) -$(MAKEFLAGS) test;
	cd ./testfarm; $(MAKE) -$(MAKEFLAGS) $@;

clean cleanprofile cleancoverage cleanall:
	cd ./src; $(MAKE) -$(MAKEFLAGS) $@;
	cd ./testfarm; $(MAKE) -$(MAKEFLAGS) $@;

distclean:
	cd ./src; $(MAKE) -$(MAKEFLAGS) $@;
	cd ./testfarm; $(MAKE) -$(MAKEFLAGS) clean;
	@TAR@ cf - ./bin ./docs ./lib ./src ./testfarm * | @GZIP@ -9 >./../qtools-0.3.tgz

backup: Makefile
	cp ./Makefile ./Makefile.bak
	cd ./src; $(MAKE) -$(MAKEFLAGS) $@;
	cd ./testfarm; $(MAKE) -$(MAKEFLAGS) $@;
restore: Makefile.bak
	cp ./Makefile.bak ./Makefile
	rm ./Makefile.bak
	cd ./src; $(MAKE) -$(MAKEFLAGS) $@;
	cd ./testfarm; $(MAKE) -$(MAKEFLAGS) $@;
