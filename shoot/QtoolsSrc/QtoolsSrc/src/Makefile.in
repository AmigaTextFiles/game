# MakeFile for QuakeTools

.PHONY:  default profile coverage branch all utils install ansi test \
	clean cleanprofile cleancoverage cleanall distclean backup restore

default profile coverage all clean cleanprofile \
cleancoverage cleanall branch utils %:
	if [ -f liblists/Makefile ] ; then cd ./liblists; $(MAKE) -$(MAKEFLAGS) $@; fi
	cd ./libqtools; $(MAKE) -$(MAKEFLAGS) $@;
	cd ./libqbuild; $(MAKE) -$(MAKEFLAGS) $@;
	cd ./libqdisplay; $(MAKE) -$(MAKEFLAGS) $@;
	cd ./libqsys; $(MAKE) -$(MAKEFLAGS) $@;
	cd ./util; $(MAKE) -$(MAKEFLAGS) $@;

test:
	cd ./util; $(MAKE) -$(MAKEFLAGS) $@;

distclean: cleanall
	rm -f ./include/config.h
	rm -f ./Makefile ./Makefile-rules

backup: Makefile
	if [ -f liblists/Makefile ] ; then cd ./liblists; $(MAKE) -$(MAKEFLAGS) $@; fi
	cp ./include/config.h ./include/config.bak
	cd ./libqtools; $(MAKE) -$(MAKEFLAGS) $@;
	cd ./libqbuild; $(MAKE) -$(MAKEFLAGS) $@;
	cd ./libqdisplay; $(MAKE) -$(MAKEFLAGS) $@;
	cd ./libqsys; $(MAKE) -$(MAKEFLAGS) $@;
	cd ./util; $(MAKE) -$(MAKEFLAGS) $@;
	cp ./Makefile ./Makefile.bak
	cp ./Makefile-rules ./Makefile-rules.bak
restore: Makefile.bak
	if [ -f liblists/Makefile ] ; then cd ./liblists; $(MAKE) -$(MAKEFLAGS) $@; fi
	cp ./include/config.bak ./include/config.h
	rm ./include/config.bak
	cd ./libqtools; $(MAKE) -$(MAKEFLAGS) $@;
	cd ./libqbuild; $(MAKE) -$(MAKEFLAGS) $@;
	cd ./libqdisplay; $(MAKE) -$(MAKEFLAGS) $@;
	cd ./libqsys; $(MAKE) -$(MAKEFLAGS) $@;
	cd ./util; $(MAKE) -$(MAKEFLAGS) $@;
	cp ./Makefile.bak ./Makefile
	rm ./Makefile.bak
	cp ./Makefile-rules.bak ./Makefile-rules
	rm ./Makefile-rules.bak
